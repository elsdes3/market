<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Machine Learning Project - ML Development</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../notebooks/02-train/notebooks/05_get_best_model.html" rel="next">
<link href="../../../index.html" rel="prev">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Machine Learning Project</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../notebooks/02-train/notebooks/04_train.html">Train Model</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../images/lorip_square.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/02-train/notebooks/04_train.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Train Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/02-train/notebooks/05_get_best_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Register Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/02-train/notebooks/06_design_experiment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sample Sizes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/02-train/notebooks/07_get_audience_cohorts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get Audience</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/03-explore/notebooks/08_explore_best_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vital Features</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/04-upload/notebooks/09_upload.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Upload Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/05-dash/notebooks/10_dash.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dashboard</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/02-train/notebooks/11_analyze_campaign_outputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Post-Campaign</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/02-train/notebooks/12_cleanup_mlflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clean MLFlow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../notebooks/07-cleanup/notebooks/13_cleanup_gcloud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clean GCloud</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#about" id="toc-about" class="nav-link active" data-scroll-target="#about">About</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#timelines-and-data-splits" id="toc-timelines-and-data-splits" class="nav-link" data-scroll-target="#timelines-and-data-splits">Timelines and Data Splits</a></li>
  <li><a href="#ml-model-development" id="toc-ml-model-development" class="nav-link" data-scroll-target="#ml-model-development">ML Model Development</a></li>
  <li><a href="#ml-evaluation" id="toc-ml-evaluation" class="nav-link" data-scroll-target="#ml-evaluation">ML Evaluation</a></li>
  <li><a href="#ml-experiment-tracking" id="toc-ml-experiment-tracking" class="nav-link" data-scroll-target="#ml-experiment-tracking">ML Experiment Tracking</a></li>
  </ul></li>
  <li><a href="#user-inputs" id="toc-user-inputs" class="nav-link" data-scroll-target="#user-inputs">User Inputs</a></li>
  <li><a href="#get-data" id="toc-get-data" class="nav-link" data-scroll-target="#get-data">Get Data</a>
  <ul class="collapse">
  <li><a href="#train" id="toc-train" class="nav-link" data-scroll-target="#train">Train</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation">Validation</a></li>
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test</a></li>
  <li><a href="#combine-data-and-split-for-ml-validation" id="toc-combine-data-and-split-for-ml-validation" class="nav-link" data-scroll-target="#combine-data-and-split-for-ml-validation">Combine Data and Split for ML Validation</a></li>
  <li><a href="#combine-data-for-ml-evaluation" id="toc-combine-data-for-ml-evaluation" class="nav-link" data-scroll-target="#combine-data-for-ml-evaluation">Combine Data for ML Evaluation</a></li>
  <li><a href="#combine-data-for-inference" id="toc-combine-data-for-inference" class="nav-link" data-scroll-target="#combine-data-for-inference">Combine Data for Inference</a></li>
  <li><a href="#separate-features-and-label" id="toc-separate-features-and-label" class="nav-link" data-scroll-target="#separate-features-and-label">Separate Features and Label</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#multi-collinearity" id="toc-multi-collinearity" class="nav-link" data-scroll-target="#multi-collinearity">Multi-Collinearity</a></li>
  <li><a href="#correlation-to-label" id="toc-correlation-to-label" class="nav-link" data-scroll-target="#correlation-to-label">Correlation to Label</a></li>
  <li><a href="#cardinality-of-categorical-features" id="toc-cardinality-of-categorical-features" class="nav-link" data-scroll-target="#cardinality-of-categorical-features">Cardinality of Categorical Features</a></li>
  <li><a href="#distribution-of-numerical-features" id="toc-distribution-of-numerical-features" class="nav-link" data-scroll-target="#distribution-of-numerical-features">Distribution of Numerical Features</a></li>
  <li><a href="#conversion-rates-among-categorical-features" id="toc-conversion-rates-among-categorical-features" class="nav-link" data-scroll-target="#conversion-rates-among-categorical-features">Conversion Rates Among Categorical Features</a></li>
  <li><a href="#numerical-feature-interactions" id="toc-numerical-feature-interactions" class="nav-link" data-scroll-target="#numerical-feature-interactions">Numerical Feature Interactions</a></li>
  </ul></li>
  <li><a href="#ml-pipeline" id="toc-ml-pipeline" class="nav-link" data-scroll-target="#ml-pipeline">ML Pipeline</a>
  <ul class="collapse">
  <li><a href="#feature-selection---sql" id="toc-feature-selection---sql" class="nav-link" data-scroll-target="#feature-selection---sql">Feature Selection - SQL</a></li>
  <li><a href="#feature-selection---python" id="toc-feature-selection---python" class="nav-link" data-scroll-target="#feature-selection---python">Feature Selection - Python</a></li>
  <li><a href="#feature-engineering---sql" id="toc-feature-engineering---sql" class="nav-link" data-scroll-target="#feature-engineering---sql">Feature Engineering - SQL</a></li>
  <li><a href="#feature-engineering---python" id="toc-feature-engineering---python" class="nav-link" data-scroll-target="#feature-engineering---python">Feature Engineering - Python</a></li>
  <li><a href="#feature-pre-processing" id="toc-feature-pre-processing" class="nav-link" data-scroll-target="#feature-pre-processing">Feature Pre-Processing</a></li>
  <li><a href="#pipeline" id="toc-pipeline" class="nav-link" data-scroll-target="#pipeline">Pipeline</a></li>
  </ul></li>
  <li><a href="#model-development" id="toc-model-development" class="nav-link" data-scroll-target="#model-development">Model Development</a>
  <ul class="collapse">
  <li><a href="#define-cross-validator" id="toc-define-cross-validator" class="nav-link" data-scroll-target="#define-cross-validator">Define Cross-Validator</a></li>
  <li><a href="#append-ml-model-to-pipeline" id="toc-append-ml-model-to-pipeline" class="nav-link" data-scroll-target="#append-ml-model-to-pipeline">Append ML Model to Pipeline</a></li>
  <li><a href="#hyper-parameter-tuning" id="toc-hyper-parameter-tuning" class="nav-link" data-scroll-target="#hyper-parameter-tuning">Hyper-Parameter Tuning</a></li>
  <li><a href="#get-validation-hyper-parameters-and-metrics" id="toc-get-validation-hyper-parameters-and-metrics" class="nav-link" data-scroll-target="#get-validation-hyper-parameters-and-metrics">Get Validation Hyper-Parameters and Metrics</a></li>
  <li><a href="#get-best-hyper-parameters" id="toc-get-best-hyper-parameters" class="nav-link" data-scroll-target="#get-best-hyper-parameters">Get Best Hyper-Parameters</a></li>
  <li><a href="#set-best-hyper-parameters-in-pipeline" id="toc-set-best-hyper-parameters-in-pipeline" class="nav-link" data-scroll-target="#set-best-hyper-parameters-in-pipeline">Set Best Hyper-Parameters in Pipeline</a></li>
  </ul></li>
  <li><a href="#ml-evaluation-1" id="toc-ml-evaluation-1" class="nav-link" data-scroll-target="#ml-evaluation-1">ML Evaluation</a>
  <ul class="collapse">
  <li><a href="#train-best-pipeline-using-combined-and-shuffled-training-and-validation-data" id="toc-train-best-pipeline-using-combined-and-shuffled-training-and-validation-data" class="nav-link" data-scroll-target="#train-best-pipeline-using-combined-and-shuffled-training-and-validation-data">Train Best <code>Pipeline</code> Using Combined and Shuffled Training and Validation Data</a></li>
  <li><a href="#make-predictions" id="toc-make-predictions" class="nav-link" data-scroll-target="#make-predictions">Make Predictions</a></li>
  <li><a href="#get-evaluation-metrics" id="toc-get-evaluation-metrics" class="nav-link" data-scroll-target="#get-evaluation-metrics">Get Evaluation Metrics</a></li>
  <li><a href="#optimal-discrimination-threshold-tuning" id="toc-optimal-discrimination-threshold-tuning" class="nav-link" data-scroll-target="#optimal-discrimination-threshold-tuning">Optimal Discrimination Threshold Tuning</a></li>
  <li><a href="#train-best-pipeline-using-all-available-combined-and-shuffled-data" id="toc-train-best-pipeline-using-all-available-combined-and-shuffled-data" class="nav-link" data-scroll-target="#train-best-pipeline-using-all-available-combined-and-shuffled-data">Train Best <code>Pipeline</code> Using All Available Combined and Shuffled Data</a></li>
  <li><a href="#get-validation-and-evaluation-metrics-feature-metadata-and-observation-metadata" id="toc-get-validation-and-evaluation-metrics-feature-metadata-and-observation-metadata" class="nav-link" data-scroll-target="#get-validation-and-evaluation-metrics-feature-metadata-and-observation-metadata">Get Validation and Evaluation Metrics, Feature Metadata and Observation Metadata</a></li>
  </ul></li>
  <li><a href="#ml-experiment-tracking-1" id="toc-ml-experiment-tracking-1" class="nav-link" data-scroll-target="#ml-experiment-tracking-1">ML Experiment Tracking</a>
  <ul class="collapse">
  <li><a href="#set-up-mlflow-experiment" id="toc-set-up-mlflow-experiment" class="nav-link" data-scroll-target="#set-up-mlflow-experiment">Set up MLFlow Experiment</a></li>
  <li><a href="#track-experiment-run-outputs-metrics-and-metadata" id="toc-track-experiment-run-outputs-metrics-and-metadata" class="nav-link" data-scroll-target="#track-experiment-run-outputs-metrics-and-metadata">Track Experiment Run Outputs (Metrics and Metadata)</a></li>
  <li><a href="#non-mlflow-monitoring" id="toc-non-mlflow-monitoring" class="nav-link" data-scroll-target="#non-mlflow-monitoring">Non-MLFlow Monitoring</a></li>
  </ul></li>
  <li><a href="#next-step" id="toc-next-step" class="nav-link" data-scroll-target="#next-step">Next Step</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/elsdes3/market/blob/main/notebooks/02-train/notebooks/04_train.ipynb" class="toc-action">Edit this page</a></p><p><a href="https://github.com/elsdes3/market/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ML Development</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="about" class="level2">
<h2 class="anchored" data-anchor-id="about">About</h2>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<p>Train a ML model to predict first-time US-based visitors’ propensity to make a purchase on a return visit to the Google merchandise store.</p>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>Visit data is taken from <a href="https://support.google.com/analytics/answer/7586738?hl=en&amp;ref_topic=3416089&amp;sjid=3563149692393307347-NA#zippy=%2Cin-this-article">Google Cloud’s public dataset with Google Analytics visitor transaction data</a>.</p>
</section>
<section id="timelines-and-data-splits" class="level3">
<h3 class="anchored" data-anchor-id="timelines-and-data-splits">Timelines and Data Splits</h3>
<p>The study timeline covers several months. During the study period, the visitor ID of every visitor who made a return visit to the store is retrieved. The ML model will be developed using the first visit by these visitors only, since there isn’t any useful information to be learnt from visitors who made a single visit to the store without returning. The attributes of the first visit to the store by the return visitors will be used when splitting the data for use in ML model development. Three data splits are created for ML model development, which includes model training, validation and evaluation. As mentioned above, the data splits combine to cover the study period and they occur in chronological order.</p>
<p>The training data split covers the first several months of available data and it captures attributes of the first-time visitors who were found to make a return visit to the store during the study period. The first visit occurs during these pre-determined months. The validation split covers first-time visitors to the store during the month that follows the last month of training data. Similarly, the test data split covers visitors during the month following the validation data period.</p>
</section>
<section id="ml-model-development" class="level3">
<h3 class="anchored" data-anchor-id="ml-model-development">ML Model Development</h3>
<p>The ML model is trained using the training data and scored on the validation data. Features are engineered and pre-processed using the training and validation data splits. Due to the class imbalance with most visitors not making a purchase during a return visit, over- and under-sampling techniques are used to help the model learn from attributes of first-time visits that resulted in a purchase. A ML pipeline is developed using the <a href="https://scikit-learn.org/stable/"><code>scikit-learn</code> ML framework for tabular data</a> with the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline"><code>Pipeline</code></a> class. The pipeline covers all the <a href="https://ml-course.github.io/master/notebooks/06%20-%20Data%20Preprocessing.html#lecture-6-data-preprocessing">steps that are part of typical ML training</a>, including feature engineering, pre-processing, feature selection and re-sampling (over- or under-sampling) and classification steps. If over-sampling is chosen, then this step is performed after the pre-processing step and before the classification step. If under-sampling is performed, then re-sampling is performed as the first step of the pipeline.</p>
</section>
<section id="ml-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="ml-evaluation">ML Evaluation</h3>
<p>As mentioned in the project scope, a single evaluation metric is preferred for this project. For comparison purposes, several metrics will be computed. Model selection (next step) will be performed using the primary (preferred) metric only.</p>
</section>
<section id="ml-experiment-tracking" class="level3">
<h3 class="anchored" data-anchor-id="ml-experiment-tracking">ML Experiment Tracking</h3>
<p>During this step, one or more runs of a single or multiple ML experiments will be executed.</p>
<p>A single run of a single experiment consists of training and evaluating a single pipeline (model). A grid of model hyperparameters for the pipeline is defined in the <strong>User Inputs</strong> section. These hyperparameters will be optimized (tuned) by training the pipeline on the training data split and scoring its predictions on the validation data. The best hyperparameters for the pipeline will be the ones that return the best evaluation metric on the validation data. The pipeline with the best hyperparameters will then be re-trained using the combined training and validation data and it will be used to predict and evaluate observations in the test data split. At the end of a single experiment run, all the metadata (eg. features used, best pipeline hyperparameters, metrics, etc.) and metrics associated with that run are tracked using the <a href="https://mlflow.org/">MLFlow ML lifecycle management platform</a>.</p>
<p>During the next step, the pipeline (model) with the best metric (score) on the test data split will be determined by retrieving the metadata for all experiment runs and ranking the runs based on the scoring metric on the test data split. The best model will then be tagged for further use (to generate a marketing audience) during a later step in this project.</p>
</section>
</section>
<section id="user-inputs" class="level2">
<h2 class="anchored" data-anchor-id="user-inputs">User Inputs</h2>
<p>Define the following</p>
<ol type="1">
<li>start and end dates for train, validation and test data</li>
<li>list of categorical features</li>
<li>list of categorical features present in the raw data as integers</li>
<li>list of numerical features</li>
<li>datetime features</li>
<li>features to exclude</li>
<li>name of column containing label (outcome)</li>
<li>resampling approach (over- or under-sampling)</li>
<li>primary ML scoring metric</li>
<li>hyperparameter grid</li>
<li>type of <code>scikit-learn</code> ML model</li>
<li>MLFlow-related inputs for experiment tracking</li>
</ol>
<div class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. start and end dates</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>train_start_date <span class="op">=</span> <span class="st">"20160901"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>train_end_date <span class="op">=</span> <span class="st">"20161231"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>val_start_date <span class="op">=</span> <span class="st">"20170101"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>val_end_date <span class="op">=</span> <span class="st">"20170131"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>test_start_date <span class="op">=</span> <span class="st">"20170201"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>test_end_date <span class="op">=</span> <span class="st">"20170228"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. categorical column</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>categorical_features <span class="op">=</span> [</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bounces"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"last_action"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"source"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"medium"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"channelGrouping"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"browser"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"os"</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"deviceCategory"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. categorical columns present as integers</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>categorical_features_ints <span class="op">=</span> [<span class="st">"bounces"</span>]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. numerical columns</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>numerical_features <span class="op">=</span> [</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hits"</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"promos_displayed"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"promos_clicked"</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"product_views"</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"product_clicks"</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pageviews"</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time_on_site"</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. datetime features</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>datetime_features <span class="op">=</span> [<span class="st">"quarter"</span>, <span class="st">"month"</span>, <span class="st">"day_of_month"</span>, <span class="st">"day_of_week"</span>, <span class="st">"hour"</span>]</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. features to exclude</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="op">=</span> [</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fullvisitorid"</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"visitId"</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"visitNumber"</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"visitStartTime"</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">'revenue'</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. label column</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="st">"made_purchase_on_future_visit"</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. resampling</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>resampling_approach <span class="op">=</span> <span class="st">"os"</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. scoring metric</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>primary_metric <span class="op">=</span> <span class="st">"fbeta2"</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. define hyperParameter grid</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"resampler__sampling_strategy"</span>: [<span class="fl">0.1</span>],</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"select__threshold"</span>: [<span class="fl">0.7</span>],</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"preprocessor__cat__rarecats__fe__tol"</span>: [<span class="fl">0.10</span>],</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"preprocessor__cat__rarecats__fe__n_categories"</span>: [<span class="dv">1</span>],</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">"preprocessor__cat__rarecats__fe__ignore_format"</span>: [<span class="va">True</span>],</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">"preprocessor__cat__rarecats__fe__replace_with"</span>: [<span class="st">"other"</span>],</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "clf__strategy": ["stratified"],  # model_type = DummyClassifier</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"clf__a"</span>: [<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>, <span class="fl">0.45</span>],  <span class="co"># model_type = BetaDistClassifier</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"clf__b"</span>: [<span class="fl">2.31</span>, <span class="fl">2.25</span>, <span class="fl">2.35</span>, <span class="fl">2.4</span>, <span class="fl">2.5</span>],  <span class="co"># model_type = BetaDistClassifier</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. type of model</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>model_type <span class="op">=</span> <span class="st">"BetaDistClassifier"</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># 12. mlflow</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>mlflow_expt_name <span class="op">=</span> <span class="st">"My Demo Experiment 2"</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>mlflow_unwanted_tracking_cols <span class="op">=</span> [</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tags.mlflow.source.name"</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tags.mlflow.source.type"</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tags.mlflow.user"</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artifact_uri"</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"start_time"</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">"end_time"</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>cleanup_mlflow <span class="op">=</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A helper function will be created to programmatically load data from BigQuery based on the desired start and end dates. The function accepts the following</p>
<ol type="1">
<li>start and end dates for which data is to be retrieved
<ul>
<li>these dates will be different for the training, validation and test splits</li>
</ul></li>
<li>start date for the training data and end date for the test data
<ul>
<li>these two dates define the period over which ML model development will occur</li>
<li>these are used to retrieve visitors who made a purchase on a return (future) visit to the store during this period</li>
</ul></li>
</ol>
<p>The function is defined in <code>src/sql_helpers.py</code>.</p>
</section>
<section id="get-data" class="level2">
<h2 class="anchored" data-anchor-id="get-data">Get Data</h2>
<section id="train" class="level3">
<h3 class="anchored" data-anchor-id="train">Train</h3>
<div class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>query_train <span class="op">=</span> sqlh.get_sql_query(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    train_start_date, train_end_date, train_start_date, test_end_date</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df_train, _ <span class="op">=</span> th.extract_data(query_train, gcp_auth_dict).pipe(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    th.transform_data,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    datatypes_dict<span class="op">=</span>dtypes_dict,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    duplicate_cols<span class="op">=</span>[<span class="st">"fullvisitorid"</span>],</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    column_mapper_dict<span class="op">=</span>{<span class="st">'last_action'</span>: action_mapper},</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># categoricals=list(set(categorical_features) - set(categorical_features_ints)),</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># df_train.pipe(th.load_data, processed_data_dir, "train")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Query execution start time = 2023-07-07 14:51:41.915...done at 2023-07-07 14:51:58.819 (16.904 seconds).
Query returned 92,859 rows
Got 92,551 rows and 29 columns after dropping duplicates
Transformed data has 92,551 rows &amp; 29 columns</code></pre>
</div>
</div>
</section>
<section id="validation" class="level3">
<h3 class="anchored" data-anchor-id="validation">Validation</h3>
<div class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>query_val <span class="op">=</span> sqlh.get_sql_query(val_start_date, val_end_date, train_start_date, test_end_date)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_val, _ <span class="op">=</span> th.extract_data(query_val, gcp_auth_dict).pipe(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    th.transform_data,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    datatypes_dict<span class="op">=</span>dtypes_dict,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    duplicate_cols<span class="op">=</span>[<span class="st">"fullvisitorid"</span>],</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    column_mapper_dict<span class="op">=</span>{<span class="st">'last_action'</span>: action_mapper},</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># df_val.pipe(th.load_data, processed_data_dir, "val")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Query execution start time = 2023-07-07 14:51:58.921...done at 2023-07-07 14:52:03.643 (4.722 seconds).
Query returned 21,208 rows
Got 21,177 rows and 29 columns after dropping duplicates
Transformed data has 21,177 rows &amp; 29 columns</code></pre>
</div>
</div>
</section>
<section id="test" class="level3">
<h3 class="anchored" data-anchor-id="test">Test</h3>
<div class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>query_test <span class="op">=</span> sqlh.get_sql_query(test_start_date, test_end_date, train_start_date, test_end_date)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_test, cat_mapper_dicts_test <span class="op">=</span> th.extract_data(query_test, gcp_auth_dict).pipe(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    th.transform_data,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    datatypes_dict<span class="op">=</span>dtypes_dict,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    duplicate_cols<span class="op">=</span>[<span class="st">"fullvisitorid"</span>],</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    column_mapper_dict<span class="op">=</span>{<span class="st">'last_action'</span>: action_mapper},</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># df_test.pipe(th.load_data, processed_data_dir, "test")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Query execution start time = 2023-07-07 14:52:03.686...done at 2023-07-07 14:52:08.916 (5.229 seconds).
Query returned 20,180 rows
Got 20,164 rows and 29 columns after dropping duplicates
Transformed data has 20,164 rows &amp; 29 columns</code></pre>
</div>
</div>
</section>
<section id="combine-data-and-split-for-ml-validation" class="level3">
<h3 class="anchored" data-anchor-id="combine-data-and-split-for-ml-validation">Combine Data and Split for ML Validation</h3>
<p>Create combined training and validation data, where only the training data has been shuffled</p>
<div class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_train, df_train_val <span class="op">=</span> th.create_combined_validation_data(df_train, df_val, dtypes_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combine-data-for-ml-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="combine-data-for-ml-evaluation">Combine Data for ML Evaluation</h3>
<p>Create combined training and validation data that has been shuffled</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_train_val_eval <span class="op">=</span> (</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    pd.concat([df_train, df_val])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    .pipe(th.set_datatypes, dtypes_dict)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    .pipe(th.shuffle_data)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combine-data-for-inference" class="level3">
<h3 class="anchored" data-anchor-id="combine-data-for-inference">Combine Data for Inference</h3>
<p>Shuffle all available data</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_all <span class="op">=</span> (</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    pd.concat([df_train, df_val, df_test])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    .pipe(th.set_datatypes, dtypes_dict)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    .pipe(th.shuffle_data)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="separate-features-and-label" class="level3">
<h3 class="anchored" data-anchor-id="separate-features-and-label">Separate Features and Label</h3>
<div class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    X_train,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    y_train,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    X_val,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    y_val,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    X_train_val,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    y_train_val,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    X_train_val_eval,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    y_train_val_eval,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    X_test,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    y_test,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> xyh.get_feats_label(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    df_train,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    df_val,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    df_train_val,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    df_train_val_eval,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    df_test,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    df_all,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    cols_to_drop,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    label,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<p>Get features that will be used in ML development (excludes ID features such as <code>fullvisitorid</code>, etc.)</p>
<div class="cell" data-tags="[]" data-execution_count="21">
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">quarter</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day_of_month</th>
<th data-quarto-table-cell-role="th">day_of_week</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">hits</th>
<th data-quarto-table-cell-role="th">promos_displayed</th>
<th data-quarto-table-cell-role="th">promos_clicked</th>
<th data-quarto-table-cell-role="th">product_views</th>
<th data-quarto-table-cell-role="th">product_clicks</th>
<th data-quarto-table-cell-role="th">pageviews</th>
<th data-quarto-table-cell-role="th">time_on_site</th>
<th data-quarto-table-cell-role="th">bounces</th>
<th data-quarto-table-cell-role="th">last_action</th>
<th data-quarto-table-cell-role="th">source</th>
<th data-quarto-table-cell-role="th">medium</th>
<th data-quarto-table-cell-role="th">channelGrouping</th>
<th data-quarto-table-cell-role="th">browser</th>
<th data-quarto-table-cell-role="th">os</th>
<th data-quarto-table-cell-role="th">deviceCategory</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">35085</td>
<td>4</td>
<td>12</td>
<td>25</td>
<td>1</td>
<td>21</td>
<td>5</td>
<td>9</td>
<td>0</td>
<td>36</td>
<td>0</td>
<td>5</td>
<td>54</td>
<td>0</td>
<td>Unknown</td>
<td>google</td>
<td>organic</td>
<td>Organic Search</td>
<td>Opera</td>
<td>Macintosh</td>
<td>desktop</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">52568</td>
<td>3</td>
<td>9</td>
<td>11</td>
<td>1</td>
<td>10</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>Unknown</td>
<td>google</td>
<td>organic</td>
<td>Organic Search</td>
<td>Chrome</td>
<td>Android</td>
<td>mobile</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40346</td>
<td>4</td>
<td>12</td>
<td>8</td>
<td>5</td>
<td>13</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>Unknown</td>
<td>(direct)</td>
<td>(none)</td>
<td>Direct</td>
<td>Chrome</td>
<td>Linux</td>
<td>desktop</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">91911</td>
<td>4</td>
<td>10</td>
<td>13</td>
<td>5</td>
<td>20</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>12</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>Unknown</td>
<td>google</td>
<td>organic</td>
<td>Organic Search</td>
<td>Safari</td>
<td>iOS</td>
<td>mobile</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9236</td>
<td>3</td>
<td>9</td>
<td>6</td>
<td>3</td>
<td>20</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>23</td>
<td>0</td>
<td>2</td>
<td>7</td>
<td>0</td>
<td>Unknown</td>
<td>(direct)</td>
<td>(none)</td>
<td>Direct</td>
<td>Chrome</td>
<td>Macintosh</td>
<td>desktop</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="multi-collinearity" class="level3">
<h3 class="anchored" data-anchor-id="multi-collinearity">Multi-Collinearity</h3>
<p>Check for multi-collinearity among all features using feature correlation heatmap</p>
<div class="cell" data-tags="[]" data-execution_count="23">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_1a05b_row0_col0, #T_1a05b_row0_col1, #T_1a05b_row0_col2, #T_1a05b_row0_col3, #T_1a05b_row0_col4, #T_1a05b_row0_col5, #T_1a05b_row0_col6, #T_1a05b_row0_col7, #T_1a05b_row0_col8, #T_1a05b_row0_col9, #T_1a05b_row0_col10, #T_1a05b_row0_col11, #T_1a05b_row0_col12, #T_1a05b_row0_col13, #T_1a05b_row0_col14, #T_1a05b_row0_col15, #T_1a05b_row0_col16, #T_1a05b_row0_col17, #T_1a05b_row1_col1, #T_1a05b_row1_col2, #T_1a05b_row1_col3, #T_1a05b_row1_col4, #T_1a05b_row1_col5, #T_1a05b_row1_col6, #T_1a05b_row1_col7, #T_1a05b_row1_col8, #T_1a05b_row1_col9, #T_1a05b_row1_col10, #T_1a05b_row1_col11, #T_1a05b_row1_col12, #T_1a05b_row1_col13, #T_1a05b_row1_col14, #T_1a05b_row1_col15, #T_1a05b_row1_col16, #T_1a05b_row1_col17, #T_1a05b_row2_col2, #T_1a05b_row2_col3, #T_1a05b_row2_col4, #T_1a05b_row2_col5, #T_1a05b_row2_col6, #T_1a05b_row2_col7, #T_1a05b_row2_col8, #T_1a05b_row2_col9, #T_1a05b_row2_col10, #T_1a05b_row2_col11, #T_1a05b_row2_col12, #T_1a05b_row2_col13, #T_1a05b_row2_col14, #T_1a05b_row2_col15, #T_1a05b_row2_col16, #T_1a05b_row2_col17, #T_1a05b_row3_col3, #T_1a05b_row3_col4, #T_1a05b_row3_col5, #T_1a05b_row3_col6, #T_1a05b_row3_col7, #T_1a05b_row3_col8, #T_1a05b_row3_col9, #T_1a05b_row3_col10, #T_1a05b_row3_col11, #T_1a05b_row3_col12, #T_1a05b_row3_col13, #T_1a05b_row3_col14, #T_1a05b_row3_col15, #T_1a05b_row3_col16, #T_1a05b_row3_col17, #T_1a05b_row4_col4, #T_1a05b_row4_col5, #T_1a05b_row4_col6, #T_1a05b_row4_col7, #T_1a05b_row4_col8, #T_1a05b_row4_col9, #T_1a05b_row4_col10, #T_1a05b_row4_col11, #T_1a05b_row4_col12, #T_1a05b_row4_col13, #T_1a05b_row4_col14, #T_1a05b_row4_col15, #T_1a05b_row4_col16, #T_1a05b_row4_col17, #T_1a05b_row5_col5, #T_1a05b_row5_col6, #T_1a05b_row5_col7, #T_1a05b_row5_col8, #T_1a05b_row5_col9, #T_1a05b_row5_col10, #T_1a05b_row5_col11, #T_1a05b_row5_col12, #T_1a05b_row5_col13, #T_1a05b_row5_col14, #T_1a05b_row5_col15, #T_1a05b_row5_col16, #T_1a05b_row5_col17, #T_1a05b_row6_col6, #T_1a05b_row6_col7, #T_1a05b_row6_col8, #T_1a05b_row6_col9, #T_1a05b_row6_col10, #T_1a05b_row6_col11, #T_1a05b_row6_col12, #T_1a05b_row6_col13, #T_1a05b_row6_col14, #T_1a05b_row6_col15, #T_1a05b_row6_col16, #T_1a05b_row6_col17, #T_1a05b_row7_col7, #T_1a05b_row7_col8, #T_1a05b_row7_col9, #T_1a05b_row7_col10, #T_1a05b_row7_col11, #T_1a05b_row7_col12, #T_1a05b_row7_col13, #T_1a05b_row7_col14, #T_1a05b_row7_col15, #T_1a05b_row7_col16, #T_1a05b_row7_col17, #T_1a05b_row8_col8, #T_1a05b_row8_col9, #T_1a05b_row8_col10, #T_1a05b_row8_col11, #T_1a05b_row8_col12, #T_1a05b_row8_col13, #T_1a05b_row8_col14, #T_1a05b_row8_col15, #T_1a05b_row8_col16, #T_1a05b_row8_col17, #T_1a05b_row9_col9, #T_1a05b_row9_col10, #T_1a05b_row9_col11, #T_1a05b_row9_col12, #T_1a05b_row9_col13, #T_1a05b_row9_col14, #T_1a05b_row9_col15, #T_1a05b_row9_col16, #T_1a05b_row9_col17, #T_1a05b_row10_col10, #T_1a05b_row10_col11, #T_1a05b_row10_col12, #T_1a05b_row10_col13, #T_1a05b_row10_col14, #T_1a05b_row10_col15, #T_1a05b_row10_col16, #T_1a05b_row10_col17, #T_1a05b_row11_col11, #T_1a05b_row11_col12, #T_1a05b_row11_col13, #T_1a05b_row11_col14, #T_1a05b_row11_col15, #T_1a05b_row11_col16, #T_1a05b_row11_col17, #T_1a05b_row12_col12, #T_1a05b_row12_col13, #T_1a05b_row12_col14, #T_1a05b_row12_col15, #T_1a05b_row12_col16, #T_1a05b_row12_col17, #T_1a05b_row13_col13, #T_1a05b_row13_col14, #T_1a05b_row13_col15, #T_1a05b_row13_col16, #T_1a05b_row13_col17, #T_1a05b_row14_col14, #T_1a05b_row14_col15, #T_1a05b_row14_col16, #T_1a05b_row14_col17, #T_1a05b_row15_col15, #T_1a05b_row15_col16, #T_1a05b_row15_col17, #T_1a05b_row16_col16, #T_1a05b_row16_col17, #T_1a05b_row17_col17 {
  background-color: #000000;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row0_col18, #T_1a05b_row1_col18, #T_1a05b_row2_col18, #T_1a05b_row3_col2, #T_1a05b_row3_col18, #T_1a05b_row4_col3, #T_1a05b_row4_col18, #T_1a05b_row5_col18, #T_1a05b_row6_col18, #T_1a05b_row7_col18, #T_1a05b_row8_col0, #T_1a05b_row8_col1, #T_1a05b_row8_col18, #T_1a05b_row9_col18, #T_1a05b_row10_col18, #T_1a05b_row11_col18, #T_1a05b_row12_col4, #T_1a05b_row12_col5, #T_1a05b_row12_col6, #T_1a05b_row12_col7, #T_1a05b_row12_col8, #T_1a05b_row12_col9, #T_1a05b_row12_col10, #T_1a05b_row12_col11, #T_1a05b_row12_col18, #T_1a05b_row13_col12, #T_1a05b_row13_col18, #T_1a05b_row14_col18, #T_1a05b_row15_col18, #T_1a05b_row16_col18, #T_1a05b_row17_col18, #T_1a05b_row18_col18, #T_1a05b_row19_col13, #T_1a05b_row19_col14, #T_1a05b_row19_col15, #T_1a05b_row19_col16, #T_1a05b_row19_col17, #T_1a05b_row19_col18 {
  background-color: #ffffcc;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row1_col0, #T_1a05b_row7_col6, #T_1a05b_row8_col7, #T_1a05b_row10_col5, #T_1a05b_row10_col8, #T_1a05b_row10_col9, #T_1a05b_row11_col10, #T_1a05b_row13_col1, #T_1a05b_row13_col11, #T_1a05b_row14_col13, #T_1a05b_row16_col14, #T_1a05b_row16_col15, #T_1a05b_row17_col12, #T_1a05b_row18_col16, #T_1a05b_row18_col17, #T_1a05b_row19_col2, #T_1a05b_row19_col3, #T_1a05b_row19_col4 {
  background-color: #800026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row2_col0, #T_1a05b_row10_col0, #T_1a05b_row12_col0 {
  background-color: #fedc7c;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row2_col1, #T_1a05b_row16_col7 {
  background-color: #fd7e38;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row3_col0 {
  background-color: #fee288;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row3_col1, #T_1a05b_row5_col4, #T_1a05b_row11_col9 {
  background-color: #e8241f;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row4_col0, #T_1a05b_row14_col9, #T_1a05b_row19_col0 {
  background-color: #fed976;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row4_col1, #T_1a05b_row11_col7, #T_1a05b_row18_col2 {
  background-color: #d10e21;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row4_col2 {
  background-color: #fc592d;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row5_col0 {
  background-color: #fedd7f;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row5_col1 {
  background-color: #e9261f;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row5_col2 {
  background-color: #fd7836;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row5_col3, #T_1a05b_row10_col3, #T_1a05b_row18_col6 {
  background-color: #fea546;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row6_col0 {
  background-color: #fede80;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row6_col1 {
  background-color: #f84528;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row6_col2, #T_1a05b_row18_col8 {
  background-color: #fed16e;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row6_col3, #T_1a05b_row15_col2, #T_1a05b_row16_col1 {
  background-color: #fd9941;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row6_col4, #T_1a05b_row11_col2 {
  background-color: #fc4f2a;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row6_col5, #T_1a05b_row13_col7, #T_1a05b_row17_col7 {
  background-color: #fc6430;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row7_col0 {
  background-color: #fee38b;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row7_col1 {
  background-color: #feb44e;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row7_col2 {
  background-color: #ffeda0;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row7_col3, #T_1a05b_row15_col4 {
  background-color: #f84628;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row7_col4, #T_1a05b_row9_col1, #T_1a05b_row13_col6 {
  background-color: #f64227;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row7_col5 {
  background-color: #fd9c42;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row8_col2, #T_1a05b_row15_col5 {
  background-color: #fed572;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row8_col3 {
  background-color: #fd7636;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row8_col4 {
  background-color: #d7121f;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row8_col5 {
  background-color: #ce0c22;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row8_col6, #T_1a05b_row11_col1 {
  background-color: #c80723;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row9_col0 {
  background-color: #fee085;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row9_col2 {
  background-color: #fc4d2a;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row9_col3, #T_1a05b_row17_col6 {
  background-color: #fd9d43;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row9_col4, #T_1a05b_row13_col8, #T_1a05b_row17_col16 {
  background-color: #f94828;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row9_col5 {
  background-color: #b00026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row9_col6 {
  background-color: #f43e26;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row9_col7, #T_1a05b_row12_col1 {
  background-color: #ea2920;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row9_col8 {
  background-color: #cf0c21;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row10_col1 {
  background-color: #e0181d;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row10_col2 {
  background-color: #fd7034;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row10_col4 {
  background-color: #e41c1d;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row10_col6, #T_1a05b_row19_col12 {
  background-color: #8d0026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row10_col7 {
  background-color: #970026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row11_col0, #T_1a05b_row16_col5, #T_1a05b_row17_col10 {
  background-color: #fed774;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row11_col3 {
  background-color: #feaf4b;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row11_col4, #T_1a05b_row14_col7 {
  background-color: #fc6832;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row11_col5 {
  background-color: #da141e;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row11_col6 {
  background-color: #d00d21;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row11_col8, #T_1a05b_row17_col3 {
  background-color: #d6111f;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row12_col2 {
  background-color: #bd0026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row12_col3 {
  background-color: #f54026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row13_col0 {
  background-color: #fed36f;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row13_col2 {
  background-color: #c90823;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row13_col3 {
  background-color: #feae4a;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row13_col4 {
  background-color: #f13824;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row13_col5 {
  background-color: #e61f1d;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row13_col9 {
  background-color: #ec2c21;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row13_col10 {
  background-color: #9f0026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row14_col0, #T_1a05b_row18_col0 {
  background-color: #fedb7b;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row14_col1 {
  background-color: #fb4b29;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row14_col2, #T_1a05b_row16_col4 {
  background-color: #fd9841;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row14_col3, #T_1a05b_row18_col13 {
  background-color: #febf5a;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row14_col4 {
  background-color: #ca0923;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row14_col5 {
  background-color: #fec662;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row14_col6 {
  background-color: #fc5d2e;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row14_col8, #T_1a05b_row16_col13 {
  background-color: #fea848;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row14_col10, #T_1a05b_row14_col11 {
  background-color: #fea747;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row14_col12 {
  background-color: #febd57;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row15_col0, #T_1a05b_row16_col9, #T_1a05b_row19_col5 {
  background-color: #fee187;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row15_col1 {
  background-color: #feab49;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row15_col3 {
  background-color: #fd8a3b;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row15_col6, #T_1a05b_row15_col7 {
  background-color: #fc6a32;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row15_col8 {
  background-color: #feb54f;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row15_col9 {
  background-color: #fedf83;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row15_col10, #T_1a05b_row16_col11 {
  background-color: #feb953;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row15_col11, #T_1a05b_row15_col13 {
  background-color: #feb651;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row15_col12 {
  background-color: #fd8239;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row15_col14 {
  background-color: #840026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row16_col0, #T_1a05b_row18_col15 {
  background-color: #fee084;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row16_col2 {
  background-color: #fd7234;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row16_col3, #T_1a05b_row18_col7 {
  background-color: #fea044;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row16_col6 {
  background-color: #fc612f;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row16_col8 {
  background-color: #fec35e;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row16_col10 {
  background-color: #febe59;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row16_col12 {
  background-color: #fc552c;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row17_col0 {
  background-color: #fedb7a;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row17_col1, #T_1a05b_row19_col7 {
  background-color: #dd161d;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row17_col2 {
  background-color: #9b0026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row17_col4 {
  background-color: #e7231e;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row17_col5 {
  background-color: #fee289;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row17_col8 {
  background-color: #fed977;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row17_col9 {
  background-color: #ffeb9c;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row17_col11 {
  background-color: #fecc68;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row17_col13 {
  background-color: #fff4b0;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row17_col14 {
  background-color: #fff7b7;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row17_col15 {
  background-color: #ffeda1;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row18_col1 {
  background-color: #e6211e;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row18_col3 {
  background-color: #fd8439;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row18_col4 {
  background-color: #fead4a;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row18_col5 {
  background-color: #fede82;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row18_col9 {
  background-color: #ffe691;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row18_col10 {
  background-color: #fece6a;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row18_col11 {
  background-color: #fec45f;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row18_col12 {
  background-color: #ac0026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row18_col14 {
  background-color: #ffeea3;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row19_col1 {
  background-color: #a60026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row19_col6 {
  background-color: #fd883b;
  color: #f1f1f1;
  font-size: 14px;
}
#T_1a05b_row19_col8 {
  background-color: #fed673;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row19_col9 {
  background-color: #ffec9d;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row19_col10 {
  background-color: #fed470;
  color: #000000;
  font-size: 14px;
}
#T_1a05b_row19_col11 {
  background-color: #fec863;
  color: #000000;
  font-size: 14px;
}
</style>

<table id="T_1a05b" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_1a05b_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">quarter</th>
<th id="T_1a05b_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">month</th>
<th id="T_1a05b_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">day_of_month</th>
<th id="T_1a05b_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">day_of_week</th>
<th id="T_1a05b_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">hour</th>
<th id="T_1a05b_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">hits</th>
<th id="T_1a05b_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">promos_displayed</th>
<th id="T_1a05b_level0_col7" class="col_heading level0 col7" data-quarto-table-cell-role="th">promos_clicked</th>
<th id="T_1a05b_level0_col8" class="col_heading level0 col8" data-quarto-table-cell-role="th">product_views</th>
<th id="T_1a05b_level0_col9" class="col_heading level0 col9" data-quarto-table-cell-role="th">product_clicks</th>
<th id="T_1a05b_level0_col10" class="col_heading level0 col10" data-quarto-table-cell-role="th">pageviews</th>
<th id="T_1a05b_level0_col11" class="col_heading level0 col11" data-quarto-table-cell-role="th">time_on_site</th>
<th id="T_1a05b_level0_col12" class="col_heading level0 col12" data-quarto-table-cell-role="th">bounces</th>
<th id="T_1a05b_level0_col13" class="col_heading level0 col13" data-quarto-table-cell-role="th">last_action</th>
<th id="T_1a05b_level0_col14" class="col_heading level0 col14" data-quarto-table-cell-role="th">source</th>
<th id="T_1a05b_level0_col15" class="col_heading level0 col15" data-quarto-table-cell-role="th">medium</th>
<th id="T_1a05b_level0_col16" class="col_heading level0 col16" data-quarto-table-cell-role="th">channelGrouping</th>
<th id="T_1a05b_level0_col17" class="col_heading level0 col17" data-quarto-table-cell-role="th">browser</th>
<th id="T_1a05b_level0_col18" class="col_heading level0 col18" data-quarto-table-cell-role="th">os</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_1a05b_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">quarter</td>
<td id="T_1a05b_row0_col0" class="data row0 col0">nan</td>
<td id="T_1a05b_row0_col1" class="data row0 col1">nan</td>
<td id="T_1a05b_row0_col2" class="data row0 col2">nan</td>
<td id="T_1a05b_row0_col3" class="data row0 col3">nan</td>
<td id="T_1a05b_row0_col4" class="data row0 col4">nan</td>
<td id="T_1a05b_row0_col5" class="data row0 col5">nan</td>
<td id="T_1a05b_row0_col6" class="data row0 col6">nan</td>
<td id="T_1a05b_row0_col7" class="data row0 col7">nan</td>
<td id="T_1a05b_row0_col8" class="data row0 col8">nan</td>
<td id="T_1a05b_row0_col9" class="data row0 col9">nan</td>
<td id="T_1a05b_row0_col10" class="data row0 col10">nan</td>
<td id="T_1a05b_row0_col11" class="data row0 col11">nan</td>
<td id="T_1a05b_row0_col12" class="data row0 col12">nan</td>
<td id="T_1a05b_row0_col13" class="data row0 col13">nan</td>
<td id="T_1a05b_row0_col14" class="data row0 col14">nan</td>
<td id="T_1a05b_row0_col15" class="data row0 col15">nan</td>
<td id="T_1a05b_row0_col16" class="data row0 col16">nan</td>
<td id="T_1a05b_row0_col17" class="data row0 col17">nan</td>
<td id="T_1a05b_row0_col18" class="data row0 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">month</td>
<td id="T_1a05b_row1_col0" class="data row1 col0">0.749081</td>
<td id="T_1a05b_row1_col1" class="data row1 col1">nan</td>
<td id="T_1a05b_row1_col2" class="data row1 col2">nan</td>
<td id="T_1a05b_row1_col3" class="data row1 col3">nan</td>
<td id="T_1a05b_row1_col4" class="data row1 col4">nan</td>
<td id="T_1a05b_row1_col5" class="data row1 col5">nan</td>
<td id="T_1a05b_row1_col6" class="data row1 col6">nan</td>
<td id="T_1a05b_row1_col7" class="data row1 col7">nan</td>
<td id="T_1a05b_row1_col8" class="data row1 col8">nan</td>
<td id="T_1a05b_row1_col9" class="data row1 col9">nan</td>
<td id="T_1a05b_row1_col10" class="data row1 col10">nan</td>
<td id="T_1a05b_row1_col11" class="data row1 col11">nan</td>
<td id="T_1a05b_row1_col12" class="data row1 col12">nan</td>
<td id="T_1a05b_row1_col13" class="data row1 col13">nan</td>
<td id="T_1a05b_row1_col14" class="data row1 col14">nan</td>
<td id="T_1a05b_row1_col15" class="data row1 col15">nan</td>
<td id="T_1a05b_row1_col16" class="data row1 col16">nan</td>
<td id="T_1a05b_row1_col17" class="data row1 col17">nan</td>
<td id="T_1a05b_row1_col18" class="data row1 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">day_of_month</td>
<td id="T_1a05b_row2_col0" class="data row2 col0">-0.010017</td>
<td id="T_1a05b_row2_col1" class="data row2 col1">-0.059018</td>
<td id="T_1a05b_row2_col2" class="data row2 col2">nan</td>
<td id="T_1a05b_row2_col3" class="data row2 col3">nan</td>
<td id="T_1a05b_row2_col4" class="data row2 col4">nan</td>
<td id="T_1a05b_row2_col5" class="data row2 col5">nan</td>
<td id="T_1a05b_row2_col6" class="data row2 col6">nan</td>
<td id="T_1a05b_row2_col7" class="data row2 col7">nan</td>
<td id="T_1a05b_row2_col8" class="data row2 col8">nan</td>
<td id="T_1a05b_row2_col9" class="data row2 col9">nan</td>
<td id="T_1a05b_row2_col10" class="data row2 col10">nan</td>
<td id="T_1a05b_row2_col11" class="data row2 col11">nan</td>
<td id="T_1a05b_row2_col12" class="data row2 col12">nan</td>
<td id="T_1a05b_row2_col13" class="data row2 col13">nan</td>
<td id="T_1a05b_row2_col14" class="data row2 col14">nan</td>
<td id="T_1a05b_row2_col15" class="data row2 col15">nan</td>
<td id="T_1a05b_row2_col16" class="data row2 col16">nan</td>
<td id="T_1a05b_row2_col17" class="data row2 col17">nan</td>
<td id="T_1a05b_row2_col18" class="data row2 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">day_of_week</td>
<td id="T_1a05b_row3_col0" class="data row3 col0">-0.044473</td>
<td id="T_1a05b_row3_col1" class="data row3 col1">-0.011641</td>
<td id="T_1a05b_row3_col2" class="data row3 col2">-0.053422</td>
<td id="T_1a05b_row3_col3" class="data row3 col3">nan</td>
<td id="T_1a05b_row3_col4" class="data row3 col4">nan</td>
<td id="T_1a05b_row3_col5" class="data row3 col5">nan</td>
<td id="T_1a05b_row3_col6" class="data row3 col6">nan</td>
<td id="T_1a05b_row3_col7" class="data row3 col7">nan</td>
<td id="T_1a05b_row3_col8" class="data row3 col8">nan</td>
<td id="T_1a05b_row3_col9" class="data row3 col9">nan</td>
<td id="T_1a05b_row3_col10" class="data row3 col10">nan</td>
<td id="T_1a05b_row3_col11" class="data row3 col11">nan</td>
<td id="T_1a05b_row3_col12" class="data row3 col12">nan</td>
<td id="T_1a05b_row3_col13" class="data row3 col13">nan</td>
<td id="T_1a05b_row3_col14" class="data row3 col14">nan</td>
<td id="T_1a05b_row3_col15" class="data row3 col15">nan</td>
<td id="T_1a05b_row3_col16" class="data row3 col16">nan</td>
<td id="T_1a05b_row3_col17" class="data row3 col17">nan</td>
<td id="T_1a05b_row3_col18" class="data row3 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">hour</td>
<td id="T_1a05b_row4_col0" class="data row4 col0">0.008033</td>
<td id="T_1a05b_row4_col1" class="data row4 col1">0.008784</td>
<td id="T_1a05b_row4_col2" class="data row4 col2">-0.006847</td>
<td id="T_1a05b_row4_col3" class="data row4 col3">-0.021895</td>
<td id="T_1a05b_row4_col4" class="data row4 col4">nan</td>
<td id="T_1a05b_row4_col5" class="data row4 col5">nan</td>
<td id="T_1a05b_row4_col6" class="data row4 col6">nan</td>
<td id="T_1a05b_row4_col7" class="data row4 col7">nan</td>
<td id="T_1a05b_row4_col8" class="data row4 col8">nan</td>
<td id="T_1a05b_row4_col9" class="data row4 col9">nan</td>
<td id="T_1a05b_row4_col10" class="data row4 col10">nan</td>
<td id="T_1a05b_row4_col11" class="data row4 col11">nan</td>
<td id="T_1a05b_row4_col12" class="data row4 col12">nan</td>
<td id="T_1a05b_row4_col13" class="data row4 col13">nan</td>
<td id="T_1a05b_row4_col14" class="data row4 col14">nan</td>
<td id="T_1a05b_row4_col15" class="data row4 col15">nan</td>
<td id="T_1a05b_row4_col16" class="data row4 col16">nan</td>
<td id="T_1a05b_row4_col17" class="data row4 col17">nan</td>
<td id="T_1a05b_row4_col18" class="data row4 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">hits</td>
<td id="T_1a05b_row5_col0" class="data row5 col0">-0.016767</td>
<td id="T_1a05b_row5_col1" class="data row5 col1">-0.012220</td>
<td id="T_1a05b_row5_col2" class="data row5 col2">-0.011847</td>
<td id="T_1a05b_row5_col3" class="data row5 col3">-0.003207</td>
<td id="T_1a05b_row5_col4" class="data row5 col4">0.032952</td>
<td id="T_1a05b_row5_col5" class="data row5 col5">nan</td>
<td id="T_1a05b_row5_col6" class="data row5 col6">nan</td>
<td id="T_1a05b_row5_col7" class="data row5 col7">nan</td>
<td id="T_1a05b_row5_col8" class="data row5 col8">nan</td>
<td id="T_1a05b_row5_col9" class="data row5 col9">nan</td>
<td id="T_1a05b_row5_col10" class="data row5 col10">nan</td>
<td id="T_1a05b_row5_col11" class="data row5 col11">nan</td>
<td id="T_1a05b_row5_col12" class="data row5 col12">nan</td>
<td id="T_1a05b_row5_col13" class="data row5 col13">nan</td>
<td id="T_1a05b_row5_col14" class="data row5 col14">nan</td>
<td id="T_1a05b_row5_col15" class="data row5 col15">nan</td>
<td id="T_1a05b_row5_col16" class="data row5 col16">nan</td>
<td id="T_1a05b_row5_col17" class="data row5 col17">nan</td>
<td id="T_1a05b_row5_col18" class="data row5 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">promos_displayed</td>
<td id="T_1a05b_row6_col0" class="data row6 col0">-0.022836</td>
<td id="T_1a05b_row6_col1" class="data row6 col1">-0.030085</td>
<td id="T_1a05b_row6_col2" class="data row6 col2">-0.032311</td>
<td id="T_1a05b_row6_col3" class="data row6 col3">-0.001539</td>
<td id="T_1a05b_row6_col4" class="data row6 col4">0.022301</td>
<td id="T_1a05b_row6_col5" class="data row6 col5">0.426279</td>
<td id="T_1a05b_row6_col6" class="data row6 col6">nan</td>
<td id="T_1a05b_row6_col7" class="data row6 col7">nan</td>
<td id="T_1a05b_row6_col8" class="data row6 col8">nan</td>
<td id="T_1a05b_row6_col9" class="data row6 col9">nan</td>
<td id="T_1a05b_row6_col10" class="data row6 col10">nan</td>
<td id="T_1a05b_row6_col11" class="data row6 col11">nan</td>
<td id="T_1a05b_row6_col12" class="data row6 col12">nan</td>
<td id="T_1a05b_row6_col13" class="data row6 col13">nan</td>
<td id="T_1a05b_row6_col14" class="data row6 col14">nan</td>
<td id="T_1a05b_row6_col15" class="data row6 col15">nan</td>
<td id="T_1a05b_row6_col16" class="data row6 col16">nan</td>
<td id="T_1a05b_row6_col17" class="data row6 col17">nan</td>
<td id="T_1a05b_row6_col18" class="data row6 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">promos_clicked</td>
<td id="T_1a05b_row7_col0" class="data row7 col0">-0.052104</td>
<td id="T_1a05b_row7_col1" class="data row7 col1">-0.097709</td>
<td id="T_1a05b_row7_col2" class="data row7 col2">-0.043559</td>
<td id="T_1a05b_row7_col3" class="data row7 col3">0.006580</td>
<td id="T_1a05b_row7_col4" class="data row7 col4">0.025861</td>
<td id="T_1a05b_row7_col5" class="data row7 col5">0.253790</td>
<td id="T_1a05b_row7_col6" class="data row7 col6">0.483290</td>
<td id="T_1a05b_row7_col7" class="data row7 col7">nan</td>
<td id="T_1a05b_row7_col8" class="data row7 col8">nan</td>
<td id="T_1a05b_row7_col9" class="data row7 col9">nan</td>
<td id="T_1a05b_row7_col10" class="data row7 col10">nan</td>
<td id="T_1a05b_row7_col11" class="data row7 col11">nan</td>
<td id="T_1a05b_row7_col12" class="data row7 col12">nan</td>
<td id="T_1a05b_row7_col13" class="data row7 col13">nan</td>
<td id="T_1a05b_row7_col14" class="data row7 col14">nan</td>
<td id="T_1a05b_row7_col15" class="data row7 col15">nan</td>
<td id="T_1a05b_row7_col16" class="data row7 col16">nan</td>
<td id="T_1a05b_row7_col17" class="data row7 col17">nan</td>
<td id="T_1a05b_row7_col18" class="data row7 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">product_views</td>
<td id="T_1a05b_row8_col0" class="data row8 col0">-0.239617</td>
<td id="T_1a05b_row8_col1" class="data row8 col1">-0.187507</td>
<td id="T_1a05b_row8_col2" class="data row8 col2">-0.032988</td>
<td id="T_1a05b_row8_col3" class="data row8 col3">0.002304</td>
<td id="T_1a05b_row8_col4" class="data row8 col4">0.039820</td>
<td id="T_1a05b_row8_col5" class="data row8 col5">0.742744</td>
<td id="T_1a05b_row8_col6" class="data row8 col6">0.346749</td>
<td id="T_1a05b_row8_col7" class="data row8 col7">0.250322</td>
<td id="T_1a05b_row8_col8" class="data row8 col8">nan</td>
<td id="T_1a05b_row8_col9" class="data row8 col9">nan</td>
<td id="T_1a05b_row8_col10" class="data row8 col10">nan</td>
<td id="T_1a05b_row8_col11" class="data row8 col11">nan</td>
<td id="T_1a05b_row8_col12" class="data row8 col12">nan</td>
<td id="T_1a05b_row8_col13" class="data row8 col13">nan</td>
<td id="T_1a05b_row8_col14" class="data row8 col14">nan</td>
<td id="T_1a05b_row8_col15" class="data row8 col15">nan</td>
<td id="T_1a05b_row8_col16" class="data row8 col16">nan</td>
<td id="T_1a05b_row8_col17" class="data row8 col17">nan</td>
<td id="T_1a05b_row8_col18" class="data row8 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">product_clicks</td>
<td id="T_1a05b_row9_col0" class="data row9 col0">-0.036139</td>
<td id="T_1a05b_row9_col1" class="data row9 col1">-0.028941</td>
<td id="T_1a05b_row9_col2" class="data row9 col2">-0.005231</td>
<td id="T_1a05b_row9_col3" class="data row9 col3">-0.002125</td>
<td id="T_1a05b_row9_col4" class="data row9 col4">0.023944</td>
<td id="T_1a05b_row9_col5" class="data row9 col5">0.849174</td>
<td id="T_1a05b_row9_col6" class="data row9 col6">0.198756</td>
<td id="T_1a05b_row9_col7" class="data row9 col7">0.119751</td>
<td id="T_1a05b_row9_col8" class="data row9 col8">0.565724</td>
<td id="T_1a05b_row9_col9" class="data row9 col9">nan</td>
<td id="T_1a05b_row9_col10" class="data row9 col10">nan</td>
<td id="T_1a05b_row9_col11" class="data row9 col11">nan</td>
<td id="T_1a05b_row9_col12" class="data row9 col12">nan</td>
<td id="T_1a05b_row9_col13" class="data row9 col13">nan</td>
<td id="T_1a05b_row9_col14" class="data row9 col14">nan</td>
<td id="T_1a05b_row9_col15" class="data row9 col15">nan</td>
<td id="T_1a05b_row9_col16" class="data row9 col16">nan</td>
<td id="T_1a05b_row9_col17" class="data row9 col17">nan</td>
<td id="T_1a05b_row9_col18" class="data row9 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">pageviews</td>
<td id="T_1a05b_row10_col0" class="data row10 col0">-0.009281</td>
<td id="T_1a05b_row10_col1" class="data row10 col1">-0.002746</td>
<td id="T_1a05b_row10_col2" class="data row10 col2">-0.010659</td>
<td id="T_1a05b_row10_col3" class="data row10 col3">-0.003279</td>
<td id="T_1a05b_row10_col4" class="data row10 col4">0.035241</td>
<td id="T_1a05b_row10_col5" class="data row10 col5">0.981455</td>
<td id="T_1a05b_row10_col6" class="data row10 col6">0.460050</td>
<td id="T_1a05b_row10_col7" class="data row10 col7">0.228053</td>
<td id="T_1a05b_row10_col8" class="data row10 col8">0.768415</td>
<td id="T_1a05b_row10_col9" class="data row10 col9">0.773902</td>
<td id="T_1a05b_row10_col10" class="data row10 col10">nan</td>
<td id="T_1a05b_row10_col11" class="data row10 col11">nan</td>
<td id="T_1a05b_row10_col12" class="data row10 col12">nan</td>
<td id="T_1a05b_row10_col13" class="data row10 col13">nan</td>
<td id="T_1a05b_row10_col14" class="data row10 col14">nan</td>
<td id="T_1a05b_row10_col15" class="data row10 col15">nan</td>
<td id="T_1a05b_row10_col16" class="data row10 col16">nan</td>
<td id="T_1a05b_row10_col17" class="data row10 col17">nan</td>
<td id="T_1a05b_row10_col18" class="data row10 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">time_on_site</td>
<td id="T_1a05b_row11_col0" class="data row11 col0">0.012242</td>
<td id="T_1a05b_row11_col1" class="data row11 col1">0.015835</td>
<td id="T_1a05b_row11_col2" class="data row11 col2">-0.005467</td>
<td id="T_1a05b_row11_col3" class="data row11 col3">-0.004766</td>
<td id="T_1a05b_row11_col4" class="data row11 col4">0.017151</td>
<td id="T_1a05b_row11_col5" class="data row11 col5">0.688526</td>
<td id="T_1a05b_row11_col6" class="data row11 col6">0.323050</td>
<td id="T_1a05b_row11_col7" class="data row11 col7">0.162792</td>
<td id="T_1a05b_row11_col8" class="data row11 col8">0.538470</td>
<td id="T_1a05b_row11_col9" class="data row11 col9">0.503496</td>
<td id="T_1a05b_row11_col10" class="data row11 col10">0.715945</td>
<td id="T_1a05b_row11_col11" class="data row11 col11">nan</td>
<td id="T_1a05b_row11_col12" class="data row11 col12">nan</td>
<td id="T_1a05b_row11_col13" class="data row11 col13">nan</td>
<td id="T_1a05b_row11_col14" class="data row11 col14">nan</td>
<td id="T_1a05b_row11_col15" class="data row11 col15">nan</td>
<td id="T_1a05b_row11_col16" class="data row11 col16">nan</td>
<td id="T_1a05b_row11_col17" class="data row11 col17">nan</td>
<td id="T_1a05b_row11_col18" class="data row11 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">bounces</td>
<td id="T_1a05b_row12_col0" class="data row12 col0">-0.010848</td>
<td id="T_1a05b_row12_col1" class="data row12 col1">-0.014595</td>
<td id="T_1a05b_row12_col2" class="data row12 col2">0.013783</td>
<td id="T_1a05b_row12_col3" class="data row12 col3">0.007290</td>
<td id="T_1a05b_row12_col4" class="data row12 col4">-0.043013</td>
<td id="T_1a05b_row12_col5" class="data row12 col5">-0.342354</td>
<td id="T_1a05b_row12_col6" class="data row12 col6">-0.363062</td>
<td id="T_1a05b_row12_col7" class="data row12 col7">-0.204141</td>
<td id="T_1a05b_row12_col8" class="data row12 col8">-0.329448</td>
<td id="T_1a05b_row12_col9" class="data row12 col9">-0.205456</td>
<td id="T_1a05b_row12_col10" class="data row12 col10">-0.371978</td>
<td id="T_1a05b_row12_col11" class="data row12 col11">-0.306225</td>
<td id="T_1a05b_row12_col12" class="data row12 col12">nan</td>
<td id="T_1a05b_row12_col13" class="data row12 col13">nan</td>
<td id="T_1a05b_row12_col14" class="data row12 col14">nan</td>
<td id="T_1a05b_row12_col15" class="data row12 col15">nan</td>
<td id="T_1a05b_row12_col16" class="data row12 col16">nan</td>
<td id="T_1a05b_row12_col17" class="data row12 col17">nan</td>
<td id="T_1a05b_row12_col18" class="data row12 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">last_action</td>
<td id="T_1a05b_row13_col0" class="data row13 col0">0.029122</td>
<td id="T_1a05b_row13_col1" class="data row13 col1">0.055356</td>
<td id="T_1a05b_row13_col2" class="data row13 col2">0.010651</td>
<td id="T_1a05b_row13_col3" class="data row13 col3">-0.004595</td>
<td id="T_1a05b_row13_col4" class="data row13 col4">0.028135</td>
<td id="T_1a05b_row13_col5" class="data row13 col5">0.632343</td>
<td id="T_1a05b_row13_col6" class="data row13 col6">0.191592</td>
<td id="T_1a05b_row13_col7" class="data row13 col7">0.060222</td>
<td id="T_1a05b_row13_col8" class="data row13 col8">0.372113</td>
<td id="T_1a05b_row13_col9" class="data row13 col9">0.483738</td>
<td id="T_1a05b_row13_col10" class="data row13 col10">0.647406</td>
<td id="T_1a05b_row13_col11" class="data row13 col11">0.512215</td>
<td id="T_1a05b_row13_col12" class="data row13 col12">-0.340939</td>
<td id="T_1a05b_row13_col13" class="data row13 col13">nan</td>
<td id="T_1a05b_row13_col14" class="data row13 col14">nan</td>
<td id="T_1a05b_row13_col15" class="data row13 col15">nan</td>
<td id="T_1a05b_row13_col16" class="data row13 col16">nan</td>
<td id="T_1a05b_row13_col17" class="data row13 col17">nan</td>
<td id="T_1a05b_row13_col18" class="data row13 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row14" class="row_heading level0 row14" data-quarto-table-cell-role="th">source</td>
<td id="T_1a05b_row14_col0" class="data row14 col0">-0.006899</td>
<td id="T_1a05b_row14_col1" class="data row14 col1">-0.033876</td>
<td id="T_1a05b_row14_col2" class="data row14 col2">-0.017928</td>
<td id="T_1a05b_row14_col3" class="data row14 col3">-0.007011</td>
<td id="T_1a05b_row14_col4" class="data row14 col4">0.044132</td>
<td id="T_1a05b_row14_col5" class="data row14 col5">0.067279</td>
<td id="T_1a05b_row14_col6" class="data row14 col6">0.142001</td>
<td id="T_1a05b_row14_col7" class="data row14 col7">0.056123</td>
<td id="T_1a05b_row14_col8" class="data row14 col8">0.117752</td>
<td id="T_1a05b_row14_col9" class="data row14 col9">0.042476</td>
<td id="T_1a05b_row14_col10" class="data row14 col10">0.075558</td>
<td id="T_1a05b_row14_col11" class="data row14 col11">0.029560</td>
<td id="T_1a05b_row14_col12" class="data row14 col12">-0.198483</td>
<td id="T_1a05b_row14_col13" class="data row14 col13">0.004911</td>
<td id="T_1a05b_row14_col14" class="data row14 col14">nan</td>
<td id="T_1a05b_row14_col15" class="data row14 col15">nan</td>
<td id="T_1a05b_row14_col16" class="data row14 col16">nan</td>
<td id="T_1a05b_row14_col17" class="data row14 col17">nan</td>
<td id="T_1a05b_row14_col18" class="data row14 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row15" class="row_heading level0 row15" data-quarto-table-cell-role="th">medium</td>
<td id="T_1a05b_row15_col0" class="data row15 col0">-0.041812</td>
<td id="T_1a05b_row15_col1" class="data row15 col1">-0.090297</td>
<td id="T_1a05b_row15_col2" class="data row15 col2">-0.018019</td>
<td id="T_1a05b_row15_col3" class="data row15 col3">0.000465</td>
<td id="T_1a05b_row15_col4" class="data row15 col4">0.024407</td>
<td id="T_1a05b_row15_col5" class="data row15 col5">0.008560</td>
<td id="T_1a05b_row15_col6" class="data row15 col6">0.117391</td>
<td id="T_1a05b_row15_col7" class="data row15 col7">0.053306</td>
<td id="T_1a05b_row15_col8" class="data row15 col8">0.072304</td>
<td id="T_1a05b_row15_col9" class="data row15 col9">0.004452</td>
<td id="T_1a05b_row15_col10" class="data row15 col10">0.011101</td>
<td id="T_1a05b_row15_col11" class="data row15 col11">-0.011858</td>
<td id="T_1a05b_row15_col12" class="data row15 col12">-0.123936</td>
<td id="T_1a05b_row15_col13" class="data row15 col13">-0.076287</td>
<td id="T_1a05b_row15_col14" class="data row15 col14">0.919861</td>
<td id="T_1a05b_row15_col15" class="data row15 col15">nan</td>
<td id="T_1a05b_row15_col16" class="data row15 col16">nan</td>
<td id="T_1a05b_row15_col17" class="data row15 col17">nan</td>
<td id="T_1a05b_row15_col18" class="data row15 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row16" class="row_heading level0 row16" data-quarto-table-cell-role="th">channelGrouping</td>
<td id="T_1a05b_row16_col0" class="data row16 col0">-0.034796</td>
<td id="T_1a05b_row16_col1" class="data row16 col1">-0.076318</td>
<td id="T_1a05b_row16_col2" class="data row16 col2">-0.010804</td>
<td id="T_1a05b_row16_col3" class="data row16 col3">-0.002649</td>
<td id="T_1a05b_row16_col4" class="data row16 col4">0.005616</td>
<td id="T_1a05b_row16_col5" class="data row16 col5">-0.004103</td>
<td id="T_1a05b_row16_col6" class="data row16 col6">0.135331</td>
<td id="T_1a05b_row16_col7" class="data row16 col7">0.036563</td>
<td id="T_1a05b_row16_col8" class="data row16 col8">0.023964</td>
<td id="T_1a05b_row16_col9" class="data row16 col9">-0.006788</td>
<td id="T_1a05b_row16_col10" class="data row16 col10">-0.003050</td>
<td id="T_1a05b_row16_col11" class="data row16 col11">-0.017698</td>
<td id="T_1a05b_row16_col12" class="data row16 col12">-0.086492</td>
<td id="T_1a05b_row16_col13" class="data row16 col13">-0.070528</td>
<td id="T_1a05b_row16_col14" class="data row16 col14">0.930266</td>
<td id="T_1a05b_row16_col15" class="data row16 col15">0.843333</td>
<td id="T_1a05b_row16_col16" class="data row16 col16">nan</td>
<td id="T_1a05b_row16_col17" class="data row16 col17">nan</td>
<td id="T_1a05b_row16_col18" class="data row16 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row17" class="row_heading level0 row17" data-quarto-table-cell-role="th">browser</td>
<td id="T_1a05b_row17_col0" class="data row17 col0">-0.002075</td>
<td id="T_1a05b_row17_col1" class="data row17 col1">-0.000965</td>
<td id="T_1a05b_row17_col2" class="data row17 col2">0.019128</td>
<td id="T_1a05b_row17_col3" class="data row17 col3">0.013183</td>
<td id="T_1a05b_row17_col4" class="data row17 col4">0.033660</td>
<td id="T_1a05b_row17_col5" class="data row17 col5">-0.086763</td>
<td id="T_1a05b_row17_col6" class="data row17 col6">0.017105</td>
<td id="T_1a05b_row17_col7" class="data row17 col7">0.059310</td>
<td id="T_1a05b_row17_col8" class="data row17 col8">-0.057850</td>
<td id="T_1a05b_row17_col9" class="data row17 col9">-0.069271</td>
<td id="T_1a05b_row17_col10" class="data row17 col10">-0.094006</td>
<td id="T_1a05b_row17_col11" class="data row17 col11">-0.068899</td>
<td id="T_1a05b_row17_col12" class="data row17 col12">0.075440</td>
<td id="T_1a05b_row17_col13" class="data row17 col13">-0.112137</td>
<td id="T_1a05b_row17_col14" class="data row17 col14">-0.048613</td>
<td id="T_1a05b_row17_col15" class="data row17 col15">0.020718</td>
<td id="T_1a05b_row17_col16" class="data row17 col16">-0.015731</td>
<td id="T_1a05b_row17_col17" class="data row17 col17">nan</td>
<td id="T_1a05b_row17_col18" class="data row17 col18">nan</td>
</tr>
<tr class="odd">
<td id="T_1a05b_level0_row18" class="row_heading level0 row18" data-quarto-table-cell-role="th">os</td>
<td id="T_1a05b_row18_col0" class="data row18 col0">-0.007591</td>
<td id="T_1a05b_row18_col1" class="data row18 col1">-0.009871</td>
<td id="T_1a05b_row18_col2" class="data row18 col2">0.008695</td>
<td id="T_1a05b_row18_col3" class="data row18 col3">0.001091</td>
<td id="T_1a05b_row18_col4" class="data row18 col4">-0.001716</td>
<td id="T_1a05b_row18_col5" class="data row18 col5">-0.055970</td>
<td id="T_1a05b_row18_col6" class="data row18 col6">-0.006939</td>
<td id="T_1a05b_row18_col7" class="data row18 col7">-0.006013</td>
<td id="T_1a05b_row18_col8" class="data row18 col8">-0.026344</td>
<td id="T_1a05b_row18_col9" class="data row18 col9">-0.040137</td>
<td id="T_1a05b_row18_col10" class="data row18 col10">-0.058669</td>
<td id="T_1a05b_row18_col11" class="data row18 col11">-0.045375</td>
<td id="T_1a05b_row18_col12" class="data row18 col12">0.037670</td>
<td id="T_1a05b_row18_col13" class="data row18 col13">-0.079832</td>
<td id="T_1a05b_row18_col14" class="data row18 col14">0.014634</td>
<td id="T_1a05b_row18_col15" class="data row18 col15">0.100106</td>
<td id="T_1a05b_row18_col16" class="data row18 col16">0.061665</td>
<td id="T_1a05b_row18_col17" class="data row18 col17">0.507421</td>
<td id="T_1a05b_row18_col18" class="data row18 col18">nan</td>
</tr>
<tr class="even">
<td id="T_1a05b_level0_row19" class="row_heading level0 row19" data-quarto-table-cell-role="th">deviceCategory</td>
<td id="T_1a05b_row19_col0" class="data row19 col0">0.011312</td>
<td id="T_1a05b_row19_col1" class="data row19 col1">0.036238</td>
<td id="T_1a05b_row19_col2" class="data row19 col2">0.023534</td>
<td id="T_1a05b_row19_col3" class="data row19 col3">0.022456</td>
<td id="T_1a05b_row19_col4" class="data row19 col4">0.062044</td>
<td id="T_1a05b_row19_col5" class="data row19 col5">-0.074546</td>
<td id="T_1a05b_row19_col6" class="data row19 col6">0.066973</td>
<td id="T_1a05b_row19_col7" class="data row19 col7">0.144322</td>
<td id="T_1a05b_row19_col8" class="data row19 col8">-0.045546</td>
<td id="T_1a05b_row19_col9" class="data row19 col9">-0.073743</td>
<td id="T_1a05b_row19_col10" class="data row19 col10">-0.081769</td>
<td id="T_1a05b_row19_col11" class="data row19 col11">-0.056388</td>
<td id="T_1a05b_row19_col12" class="data row19 col12">0.063732</td>
<td id="T_1a05b_row19_col13" class="data row19 col13">-0.122467</td>
<td id="T_1a05b_row19_col14" class="data row19 col14">-0.109573</td>
<td id="T_1a05b_row19_col15" class="data row19 col15">-0.096445</td>
<td id="T_1a05b_row19_col16" class="data row19 col16">-0.153370</td>
<td id="T_1a05b_row19_col17" class="data row19 col17">0.450195</td>
<td id="T_1a05b_row19_col18" class="data row19 col18">0.087484</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><code>pageviews</code> is
<ul>
<li>highly correlated (&gt;0.7) to <code>hits</code>, <code>product_clicks</code> and <code>product_views</code></li>
<li>moderately correlated (&gt;0.5 and &lt;0.7) to <code>last_action</code></li>
</ul></li>
<li><code>product_clicks</code> and <code>product_views</code> are highly correlated to <code>hits</code>.</li>
<li><code>last_action</code> is moderately correlated to <code>time_on_site</code>.</li>
<li>To allow ML model explainability, multi-collinearity must be removed from the features. So, highly-correlated features will have to be dropped. Moderately correlated features will be permitted.</li>
</ol>
</div>
</div>
</section>
<section id="correlation-to-label" class="level3">
<h3 class="anchored" data-anchor-id="correlation-to-label">Correlation to Label</h3>
<div class="cell" data-tags="[]" data-execution_count="24">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_fe16e_row0_col0, #T_fe16e_row1_col0, #T_fe16e_row2_col0, #T_fe16e_row3_col0, #T_fe16e_row4_col0, #T_fe16e_row5_col0, #T_fe16e_row6_col0, #T_fe16e_row6_col2, #T_fe16e_row7_col0, #T_fe16e_row7_col2, #T_fe16e_row8_col0, #T_fe16e_row9_col0, #T_fe16e_row10_col0, #T_fe16e_row10_col2, #T_fe16e_row11_col0, #T_fe16e_row11_col2, #T_fe16e_row12_col0, #T_fe16e_row13_col0, #T_fe16e_row13_col2, #T_fe16e_row14_col0, #T_fe16e_row15_col0, #T_fe16e_row16_col0, #T_fe16e_row17_col0, #T_fe16e_row18_col0, #T_fe16e_row19_col0 {
  font-size: 14px;
}
#T_fe16e_row0_col1 {
  background-color: #800026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_fe16e_row0_col2, #T_fe16e_row9_col2, #T_fe16e_row12_col2, #T_fe16e_row15_col2, #T_fe16e_row16_col2, #T_fe16e_row17_col2, #T_fe16e_row18_col2, #T_fe16e_row19_col2 {
  font-size: 14px;
  background-color: yellow;
}
#T_fe16e_row1_col1 {
  background-color: #dd161d;
  color: #f1f1f1;
  font-size: 14px;
}
#T_fe16e_row1_col2, #T_fe16e_row2_col2, #T_fe16e_row3_col2, #T_fe16e_row4_col2, #T_fe16e_row5_col2, #T_fe16e_row8_col2, #T_fe16e_row14_col2 {
  font-size: 14px;
  background-color: lightgreen;
}
#T_fe16e_row2_col1 {
  background-color: #e1191d;
  color: #f1f1f1;
  font-size: 14px;
}
#T_fe16e_row3_col1 {
  background-color: #eb2b21;
  color: #f1f1f1;
  font-size: 14px;
}
#T_fe16e_row4_col1 {
  background-color: #f84528;
  color: #f1f1f1;
  font-size: 14px;
}
#T_fe16e_row5_col1 {
  background-color: #fd7e38;
  color: #f1f1f1;
  font-size: 14px;
}
#T_fe16e_row6_col1 {
  background-color: #fd933f;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row7_col1 {
  background-color: #fd9a42;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row8_col1 {
  background-color: #fea446;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row9_col1 {
  background-color: #fead4a;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row10_col1 {
  background-color: #febd57;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row11_col1 {
  background-color: #febf5a;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row12_col1 {
  background-color: #fecb67;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row13_col1 {
  background-color: #fecf6b;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row14_col1 {
  background-color: #fed470;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row15_col1 {
  background-color: #ffe58f;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row16_col1 {
  background-color: #fff0a7;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row17_col1 {
  background-color: #fffac0;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row18_col1 {
  background-color: #fffbc2;
  color: #000000;
  font-size: 14px;
}
#T_fe16e_row19_col1 {
  background-color: #ffffcc;
  color: #000000;
  font-size: 14px;
}
</style>

<table id="T_fe16e" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_fe16e_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">feature</th>
<th id="T_fe16e_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">corr</th>
<th id="T_fe16e_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">feature_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_fe16e_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_fe16e_row0_col0" class="data row0 col0">last_action</td>
<td id="T_fe16e_row0_col1" class="data row0 col1">0.224843</td>
<td id="T_fe16e_row0_col2" class="data row0 col2">categorical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_fe16e_row1_col0" class="data row1 col0">pageviews</td>
<td id="T_fe16e_row1_col1" class="data row1 col1">0.146894</td>
<td id="T_fe16e_row1_col2" class="data row1 col2">numerical</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_fe16e_row2_col0" class="data row2 col0">hits</td>
<td id="T_fe16e_row2_col1" class="data row2 col1">0.142949</td>
<td id="T_fe16e_row2_col2" class="data row2 col2">numerical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_fe16e_row3_col0" class="data row3 col0">time_on_site</td>
<td id="T_fe16e_row3_col1" class="data row3 col1">0.127640</td>
<td id="T_fe16e_row3_col2" class="data row3 col2">numerical</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_fe16e_row4_col0" class="data row4 col0">product_clicks</td>
<td id="T_fe16e_row4_col1" class="data row4 col1">0.106450</td>
<td id="T_fe16e_row4_col2" class="data row4 col2">numerical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_fe16e_row5_col0" class="data row5 col0">product_views</td>
<td id="T_fe16e_row5_col1" class="data row5 col1">0.067876</td>
<td id="T_fe16e_row5_col2" class="data row5 col2">numerical</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_fe16e_row6_col0" class="data row6 col0">month</td>
<td id="T_fe16e_row6_col1" class="data row6 col1">0.050442</td>
<td id="T_fe16e_row6_col2" class="data row6 col2">datetime</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_fe16e_row7_col0" class="data row7 col0">quarter</td>
<td id="T_fe16e_row7_col1" class="data row7 col1">0.043746</td>
<td id="T_fe16e_row7_col2" class="data row7 col2">datetime</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_fe16e_row8_col0" class="data row8 col0">promos_displayed</td>
<td id="T_fe16e_row8_col1" class="data row8 col1">0.032752</td>
<td id="T_fe16e_row8_col2" class="data row8 col2">numerical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_fe16e_row9_col0" class="data row9 col0">source</td>
<td id="T_fe16e_row9_col1" class="data row9 col1">0.021764</td>
<td id="T_fe16e_row9_col2" class="data row9 col2">categorical</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">10</td>
<td id="T_fe16e_row10_col0" class="data row10 col0">day_of_month</td>
<td id="T_fe16e_row10_col1" class="data row10 col1">0.005129</td>
<td id="T_fe16e_row10_col2" class="data row10 col2">datetime</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">11</td>
<td id="T_fe16e_row11_col0" class="data row11 col0">hour</td>
<td id="T_fe16e_row11_col1" class="data row11 col1">0.002647</td>
<td id="T_fe16e_row11_col2" class="data row11 col2">datetime</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">12</td>
<td id="T_fe16e_row12_col0" class="data row12 col0">channelGrouping</td>
<td id="T_fe16e_row12_col1" class="data row12 col1">-0.010087</td>
<td id="T_fe16e_row12_col2" class="data row12 col2">categorical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">13</td>
<td id="T_fe16e_row13_col0" class="data row13 col0">day_of_week</td>
<td id="T_fe16e_row13_col1" class="data row13 col1">-0.013536</td>
<td id="T_fe16e_row13_col2" class="data row13 col2">datetime</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row14" class="row_heading level0 row14" data-quarto-table-cell-role="th">14</td>
<td id="T_fe16e_row14_col0" class="data row14 col0">promos_clicked</td>
<td id="T_fe16e_row14_col1" class="data row14 col1">-0.018678</td>
<td id="T_fe16e_row14_col2" class="data row14 col2">numerical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row15" class="row_heading level0 row15" data-quarto-table-cell-role="th">15</td>
<td id="T_fe16e_row15_col0" class="data row15 col0">medium</td>
<td id="T_fe16e_row15_col1" class="data row15 col1">-0.048723</td>
<td id="T_fe16e_row15_col2" class="data row15 col2">categorical</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row16" class="row_heading level0 row16" data-quarto-table-cell-role="th">16</td>
<td id="T_fe16e_row16_col0" class="data row16 col0">os</td>
<td id="T_fe16e_row16_col1" class="data row16 col1">-0.073147</td>
<td id="T_fe16e_row16_col2" class="data row16 col2">categorical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row17" class="row_heading level0 row17" data-quarto-table-cell-role="th">17</td>
<td id="T_fe16e_row17_col0" class="data row17 col0">bounces</td>
<td id="T_fe16e_row17_col1" class="data row17 col1">-0.096290</td>
<td id="T_fe16e_row17_col2" class="data row17 col2">categorical</td>
</tr>
<tr class="odd">
<td id="T_fe16e_level0_row18" class="row_heading level0 row18" data-quarto-table-cell-role="th">18</td>
<td id="T_fe16e_row18_col0" class="data row18 col0">browser</td>
<td id="T_fe16e_row18_col1" class="data row18 col1">-0.098377</td>
<td id="T_fe16e_row18_col2" class="data row18 col2">categorical</td>
</tr>
<tr class="even">
<td id="T_fe16e_level0_row19" class="row_heading level0 row19" data-quarto-table-cell-role="th">19</td>
<td id="T_fe16e_row19_col0" class="data row19 col0">deviceCategory</td>
<td id="T_fe16e_row19_col1" class="data row19 col1">-0.108512</td>
<td id="T_fe16e_row19_col2" class="data row19 col2">categorical</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Unfortunately, the extracted features show a weak correlation (&lt;0.5) to the label.</li>
<li>The first-time visitors’ <code>last_action</code> (i.e.&nbsp;the last action they performed during their first visit) shows the highest correlation (0.23) to the label. This is a categorical feature (hilighted in yellow). The other categorcal features show a weak correlation to the label.</li>
<li>The numerical features (hilighted in light-green above) show the next strongest correlations (&gt;0.06 and &lt;0.15) to the label, but some of these features are highly correlated to eachother (as seen above) and so a subset of these numerical features will be excluded in order to support model explainability.</li>
<li>The <code>datetime</code> features (not hilighted above) are treated like categoricals in the extracted data, and they show a poor correlation to the label. Other approaches to encoding <code>datetime</code> attributes (eg. using <a href="https://towardsdatascience.com/cyclical-features-encoding-its-about-time-ce23581845ca">trigonometric functions</a>) should be explored during feature pre-processing.</li>
</ol>
</div>
</div>
</section>
<section id="cardinality-of-categorical-features" class="level3">
<h3 class="anchored" data-anchor-id="cardinality-of-categorical-features">Cardinality of Categorical Features</h3>
<div class="cell" data-tags="[]" data-execution_count="25">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">column</th>
<th data-quarto-table-cell-role="th">len_mapper_dict_train</th>
<th data-quarto-table-cell-role="th">mapper_dict_train</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>source</td>
<td>116</td>
<td>{'(direct)': 0, '(not set)': 1, '0.muppet1.frontend.gws.muppet-exp.ij-q.borg.google.com:14634': 2, '0.shared.bow.cat2.ads-bow.lf.borg.google.com:9...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>browser</td>
<td>26</td>
<td>{'Amazon Silk': 0, 'Android Browser': 1, 'Android Webview': 2, 'Apple-iPhone7C2': 3, 'BlackBerry': 4, 'Chrome': 5, 'Coc Coc': 6, 'Edge': 7, 'Firef...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>os</td>
<td>15</td>
<td>{'(not set)': 0, 'Android': 1, 'BlackBerry': 2, 'Chrome OS': 3, 'FreeBSD': 4, 'Linux': 5, 'Macintosh': 6, 'Nintendo Wii': 7, 'Nokia': 8, 'Samsung'...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>channelGrouping</td>
<td>8</td>
<td>{'(Other)': 0, 'Affiliates': 1, 'Direct': 2, 'Display': 3, 'Organic Search': 4, 'Paid Search': 5, 'Referral': 6, 'Social': 7}</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>last_action</td>
<td>7</td>
<td>{'Unknown': 0, 'Click through of product lists': 1, 'Product detail views': 2, 'Add product(s) to cart': 3, 'Remove product(s) from cart': 4, 'Che...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>medium</td>
<td>7</td>
<td>{'(none)': 0, '(not set)': 1, 'affiliate': 2, 'cpc': 3, 'cpm': 4, 'organic': 5, 'referral': 6}</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>deviceCategory</td>
<td>3</td>
<td>{'desktop': 0, 'mobile': 1, 'tablet': 2}</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>bounces</td>
<td>2</td>
<td>{0: 0, 1: 1}</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>At least three of the categorical features have a problem with high-cardinality (&gt;10 categories), which will lead to a sparse matrix and suffer from the <a href="https://www.shiksha.com/online-courses/articles/curse-of-dimensionality/">curse of dimensionality</a>. To overcome this, only the most commonly occurring values in each categorical feature will have to be kept and all the other (infrequenly occurring) values with will be replaced with an <code>other</code> value. Based on the training data, this will have to be done for the <code>source</code>, <code>browser</code> and <code>os</code> features.</li>
</ol>
</div>
</div>
<p>Show the frequency of categories for every categorical feature</p>
<div class="cell" data-tags="[]" data-execution_count="26">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_b1b35_row0_col1, #T_b1b35_row1_col1 {
  background-color: yellow;
}
</style>

<table id="T_b1b35" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_b1b35_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">bounces</th>
<th id="T_b1b35_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_b1b35_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b1b35_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_b1b35_row0_col0" class="data row0 col0">0</td>
<td id="T_b1b35_row0_col1" class="data row0 col1">70.766388</td>
<td id="T_b1b35_row0_col2" class="data row0 col2">True</td>
</tr>
<tr class="even">
<td id="T_b1b35_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_b1b35_row1_col0" class="data row1 col0">1</td>
<td id="T_b1b35_row1_col1" class="data row1 col1">29.233612</td>
<td id="T_b1b35_row1_col2" class="data row1 col2">True</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_431ec_row0_col1, #T_431ec_row1_col1 {
  background-color: yellow;
}
#T_431ec_row2_col1 {
  background-color: #80FFff;
}
#T_431ec_row3_col1, #T_431ec_row4_col1, #T_431ec_row5_col1, #T_431ec_row6_col1 {
  background-color: antiquewhite;
}
</style>

<table id="T_431ec" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_431ec_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">last_action</th>
<th id="T_431ec_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_431ec_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_431ec_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_431ec_row0_col0" class="data row0 col0">Unknown</td>
<td id="T_431ec_row0_col1" class="data row0 col1">72.956532</td>
<td id="T_431ec_row0_col2" class="data row0 col2">True</td>
</tr>
<tr class="even">
<td id="T_431ec_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_431ec_row1_col0" class="data row1 col0">Product detail views</td>
<td id="T_431ec_row1_col1" class="data row1 col1">15.904744</td>
<td id="T_431ec_row1_col2" class="data row1 col2">True</td>
</tr>
<tr class="odd">
<td id="T_431ec_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_431ec_row2_col0" class="data row2 col0">Add product(s) to cart</td>
<td id="T_431ec_row2_col1" class="data row2 col1">5.029659</td>
<td id="T_431ec_row2_col2" class="data row2 col2">True</td>
</tr>
<tr class="even">
<td id="T_431ec_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_431ec_row3_col0" class="data row3 col0">Completed purchase</td>
<td id="T_431ec_row3_col1" class="data row3 col1">3.341941</td>
<td id="T_431ec_row3_col2" class="data row3 col2">True</td>
</tr>
<tr class="odd">
<td id="T_431ec_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_431ec_row4_col0" class="data row4 col0">Check out</td>
<td id="T_431ec_row4_col1" class="data row4 col1">1.769835</td>
<td id="T_431ec_row4_col2" class="data row4 col2">True</td>
</tr>
<tr class="even">
<td id="T_431ec_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_431ec_row5_col0" class="data row5 col0">Remove product(s) from cart</td>
<td id="T_431ec_row5_col1" class="data row5 col1">0.952988</td>
<td id="T_431ec_row5_col2" class="data row5 col2">True</td>
</tr>
<tr class="odd">
<td id="T_431ec_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_431ec_row6_col0" class="data row6 col0">Click through of product lists</td>
<td id="T_431ec_row6_col1" class="data row6 col1">0.044300</td>
<td id="T_431ec_row6_col2" class="data row6 col2">True</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_2fe3a_row0_col1, #T_2fe3a_row1_col1, #T_2fe3a_row2_col1 {
  background-color: yellow;
}
#T_2fe3a_row3_col1, #T_2fe3a_row4_col1, #T_2fe3a_row5_col1, #T_2fe3a_row6_col1 {
  background-color: antiquewhite;
}
</style>

<table id="T_2fe3a" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_2fe3a_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">source</th>
<th id="T_2fe3a_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_2fe3a_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_2fe3a_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_2fe3a_row0_col0" class="data row0 col0">google</td>
<td id="T_2fe3a_row0_col1" class="data row0 col1">51.563019</td>
<td id="T_2fe3a_row0_col2" class="data row0 col2">False</td>
</tr>
<tr class="even">
<td id="T_2fe3a_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_2fe3a_row1_col0" class="data row1 col0">(direct)</td>
<td id="T_2fe3a_row1_col1" class="data row1 col1">25.539585</td>
<td id="T_2fe3a_row1_col2" class="data row1 col2">False</td>
</tr>
<tr class="odd">
<td id="T_2fe3a_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_2fe3a_row2_col0" class="data row2 col0">mall.googleplex.com</td>
<td id="T_2fe3a_row2_col1" class="data row2 col1">13.963996</td>
<td id="T_2fe3a_row2_col2" class="data row2 col2">False</td>
</tr>
<tr class="even">
<td id="T_2fe3a_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_2fe3a_row3_col0" class="data row3 col0">sites.google.com</td>
<td id="T_2fe3a_row3_col1" class="data row3 col1">1.302120</td>
<td id="T_2fe3a_row3_col2" class="data row3 col2">False</td>
</tr>
<tr class="odd">
<td id="T_2fe3a_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_2fe3a_row4_col0" class="data row4 col0">moma.corp.google.com</td>
<td id="T_2fe3a_row4_col1" class="data row4 col1">1.233338</td>
<td id="T_2fe3a_row4_col2" class="data row4 col2">False</td>
</tr>
<tr class="even">
<td id="T_2fe3a_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_2fe3a_row5_col0" class="data row5 col0">Partners</td>
<td id="T_2fe3a_row5_col1" class="data row5 col1">1.066126</td>
<td id="T_2fe3a_row5_col2" class="data row5 col2">False</td>
</tr>
<tr class="odd">
<td id="T_2fe3a_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_2fe3a_row6_col0" class="data row6 col0">dfa</td>
<td id="T_2fe3a_row6_col1" class="data row6 col1">1.002087</td>
<td id="T_2fe3a_row6_col2" class="data row6 col2">False</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_16ad4_row0_col1, #T_16ad4_row1_col1, #T_16ad4_row2_col1 {
  background-color: yellow;
}
#T_16ad4_row3_col1 {
  background-color: #80FFff;
}
#T_16ad4_row4_col1, #T_16ad4_row5_col1, #T_16ad4_row6_col1 {
  background-color: antiquewhite;
}
</style>

<table id="T_16ad4" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_16ad4_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">medium</th>
<th id="T_16ad4_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_16ad4_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_16ad4_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_16ad4_row0_col0" class="data row0 col0">organic</td>
<td id="T_16ad4_row0_col1" class="data row0 col1">41.685125</td>
<td id="T_16ad4_row0_col2" class="data row0 col2">True</td>
</tr>
<tr class="even">
<td id="T_16ad4_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_16ad4_row1_col0" class="data row1 col0">referral</td>
<td id="T_16ad4_row1_col1" class="data row1 col1">27.101814</td>
<td id="T_16ad4_row1_col2" class="data row1 col2">True</td>
</tr>
<tr class="odd">
<td id="T_16ad4_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_16ad4_row2_col0" class="data row2 col0">(none)</td>
<td id="T_16ad4_row2_col1" class="data row2 col1">23.269333</td>
<td id="T_16ad4_row2_col2" class="data row2 col2">True</td>
</tr>
<tr class="even">
<td id="T_16ad4_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_16ad4_row3_col0" class="data row3 col0">cpc</td>
<td id="T_16ad4_row3_col1" class="data row3 col1">6.057201</td>
<td id="T_16ad4_row3_col2" class="data row3 col2">True</td>
</tr>
<tr class="odd">
<td id="T_16ad4_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_16ad4_row4_col0" class="data row4 col0">affiliate</td>
<td id="T_16ad4_row4_col1" class="data row4 col1">0.971356</td>
<td id="T_16ad4_row4_col2" class="data row4 col2">True</td>
</tr>
<tr class="even">
<td id="T_16ad4_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_16ad4_row5_col0" class="data row5 col0">cpm</td>
<td id="T_16ad4_row5_col1" class="data row5 col1">0.913010</td>
<td id="T_16ad4_row5_col2" class="data row5 col2">True</td>
</tr>
<tr class="odd">
<td id="T_16ad4_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_16ad4_row6_col0" class="data row6 col0">(not set)</td>
<td id="T_16ad4_row6_col1" class="data row6 col1">0.002161</td>
<td id="T_16ad4_row6_col2" class="data row6 col2">True</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_4beb8_row0_col1, #T_4beb8_row1_col1, #T_4beb8_row2_col1 {
  background-color: yellow;
}
#T_4beb8_row3_col1, #T_4beb8_row4_col1 {
  background-color: #80FFff;
}
#T_4beb8_row5_col1, #T_4beb8_row6_col1, #T_4beb8_row7_col1 {
  background-color: antiquewhite;
}
</style>

<table id="T_4beb8" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_4beb8_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">channelGrouping</th>
<th id="T_4beb8_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_4beb8_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_4beb8_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_4beb8_row0_col0" class="data row0 col0">Organic Search</td>
<td id="T_4beb8_row0_col1" class="data row0 col1">41.685125</td>
<td id="T_4beb8_row0_col2" class="data row0 col2">True</td>
</tr>
<tr class="even">
<td id="T_4beb8_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_4beb8_row1_col0" class="data row1 col0">Direct</td>
<td id="T_4beb8_row1_col1" class="data row1 col1">23.269333</td>
<td id="T_4beb8_row1_col2" class="data row1 col2">True</td>
</tr>
<tr class="odd">
<td id="T_4beb8_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_4beb8_row2_col0" class="data row2 col0">Referral</td>
<td id="T_4beb8_row2_col1" class="data row2 col1">17.457402</td>
<td id="T_4beb8_row2_col2" class="data row2 col2">True</td>
</tr>
<tr class="even">
<td id="T_4beb8_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_4beb8_row3_col0" class="data row3 col0">Social</td>
<td id="T_4beb8_row3_col1" class="data row3 col1">9.644412</td>
<td id="T_4beb8_row3_col2" class="data row3 col2">True</td>
</tr>
<tr class="odd">
<td id="T_4beb8_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_4beb8_row4_col0" class="data row4 col0">Paid Search</td>
<td id="T_4beb8_row4_col1" class="data row4 col1">6.057201</td>
<td id="T_4beb8_row4_col2" class="data row4 col2">True</td>
</tr>
<tr class="even">
<td id="T_4beb8_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_4beb8_row5_col0" class="data row5 col0">Affiliates</td>
<td id="T_4beb8_row5_col1" class="data row5 col1">0.971356</td>
<td id="T_4beb8_row5_col2" class="data row5 col2">True</td>
</tr>
<tr class="odd">
<td id="T_4beb8_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_4beb8_row6_col0" class="data row6 col0">Display</td>
<td id="T_4beb8_row6_col1" class="data row6 col1">0.913010</td>
<td id="T_4beb8_row6_col2" class="data row6 col2">True</td>
</tr>
<tr class="even">
<td id="T_4beb8_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_4beb8_row7_col0" class="data row7 col0">(Other)</td>
<td id="T_4beb8_row7_col1" class="data row7 col1">0.002161</td>
<td id="T_4beb8_row7_col2" class="data row7 col2">True</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_0c0c5_row0_col1, #T_0c0c5_row1_col1 {
  background-color: yellow;
}
#T_0c0c5_row2_col1, #T_0c0c5_row3_col1, #T_0c0c5_row4_col1, #T_0c0c5_row5_col1 {
  background-color: antiquewhite;
}
</style>

<table id="T_0c0c5" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_0c0c5_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">browser</th>
<th id="T_0c0c5_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_0c0c5_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_0c0c5_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_0c0c5_row0_col0" class="data row0 col0">Chrome</td>
<td id="T_0c0c5_row0_col1" class="data row0 col1">74.641671</td>
<td id="T_0c0c5_row0_col2" class="data row0 col2">False</td>
</tr>
<tr class="even">
<td id="T_0c0c5_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_0c0c5_row1_col0" class="data row1 col0">Safari</td>
<td id="T_0c0c5_row1_col1" class="data row1 col1">16.544249</td>
<td id="T_0c0c5_row1_col2" class="data row1 col2">False</td>
</tr>
<tr class="odd">
<td id="T_0c0c5_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_0c0c5_row2_col0" class="data row2 col0">Firefox</td>
<td id="T_0c0c5_row2_col1" class="data row2 col1">2.806053</td>
<td id="T_0c0c5_row2_col2" class="data row2 col2">False</td>
</tr>
<tr class="even">
<td id="T_0c0c5_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_0c0c5_row3_col0" class="data row3 col0">Internet Explorer</td>
<td id="T_0c0c5_row3_col1" class="data row3 col1">2.394989</td>
<td id="T_0c0c5_row3_col2" class="data row3 col2">False</td>
</tr>
<tr class="odd">
<td id="T_0c0c5_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_0c0c5_row4_col0" class="data row4 col0">Opera</td>
<td id="T_0c0c5_row4_col1" class="data row4 col1">1.210476</td>
<td id="T_0c0c5_row4_col2" class="data row4 col2">False</td>
</tr>
<tr class="even">
<td id="T_0c0c5_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_0c0c5_row5_col0" class="data row5 col0">Edge</td>
<td id="T_0c0c5_row5_col1" class="data row5 col1">1.069848</td>
<td id="T_0c0c5_row5_col2" class="data row5 col2">False</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_8329e_row0_col1, #T_8329e_row1_col1, #T_8329e_row2_col1, #T_8329e_row3_col1 {
  background-color: yellow;
}
#T_8329e_row4_col1, #T_8329e_row5_col1 {
  background-color: #80FFff;
}
#T_8329e_row6_col1, #T_8329e_row7_col1, #T_8329e_row8_col1, #T_8329e_row9_col1, #T_8329e_row10_col1, #T_8329e_row11_col1, #T_8329e_row12_col1, #T_8329e_row13_col1, #T_8329e_row14_col1 {
  background-color: antiquewhite;
}
</style>

<table id="T_8329e" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_8329e_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">os</th>
<th id="T_8329e_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_8329e_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_8329e_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_8329e_row0_col0" class="data row0 col0">Macintosh</td>
<td id="T_8329e_row0_col1" class="data row0 col1">33.073657</td>
<td id="T_8329e_row0_col2" class="data row0 col2">True</td>
</tr>
<tr class="even">
<td id="T_8329e_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_8329e_row1_col0" class="data row1 col0">Windows</td>
<td id="T_8329e_row1_col1" class="data row1 col1">27.647459</td>
<td id="T_8329e_row1_col2" class="data row1 col2">True</td>
</tr>
<tr class="odd">
<td id="T_8329e_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_8329e_row2_col0" class="data row2 col0">iOS</td>
<td id="T_8329e_row2_col1" class="data row2 col1">14.586552</td>
<td id="T_8329e_row2_col2" class="data row2 col2">True</td>
</tr>
<tr class="even">
<td id="T_8329e_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_8329e_row3_col0" class="data row3 col0">Android</td>
<td id="T_8329e_row3_col1" class="data row3 col1">12.410455</td>
<td id="T_8329e_row3_col2" class="data row3 col2">True</td>
</tr>
<tr class="odd">
<td id="T_8329e_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_8329e_row4_col0" class="data row4 col0">Linux</td>
<td id="T_8329e_row4_col1" class="data row4 col1">7.023155</td>
<td id="T_8329e_row4_col2" class="data row4 col2">True</td>
</tr>
<tr class="even">
<td id="T_8329e_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_8329e_row5_col0" class="data row5 col0">Chrome OS</td>
<td id="T_8329e_row5_col1" class="data row5 col1">5.122581</td>
<td id="T_8329e_row5_col2" class="data row5 col2">True</td>
</tr>
<tr class="odd">
<td id="T_8329e_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_8329e_row6_col0" class="data row6 col0">(not set)</td>
<td id="T_8329e_row6_col1" class="data row6 col1">0.057266</td>
<td id="T_8329e_row6_col2" class="data row6 col2">True</td>
</tr>
<tr class="even">
<td id="T_8329e_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_8329e_row7_col0" class="data row7 col0">Windows Phone</td>
<td id="T_8329e_row7_col1" class="data row7 col1">0.042139</td>
<td id="T_8329e_row7_col2" class="data row7 col2">True</td>
</tr>
<tr class="odd">
<td id="T_8329e_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_8329e_row8_col0" class="data row8 col0">Nintendo Wii</td>
<td id="T_8329e_row8_col1" class="data row8 col1">0.011885</td>
<td id="T_8329e_row8_col2" class="data row8 col2">True</td>
</tr>
<tr class="even">
<td id="T_8329e_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_8329e_row9_col0" class="data row9 col0">BlackBerry</td>
<td id="T_8329e_row9_col1" class="data row9 col1">0.010805</td>
<td id="T_8329e_row9_col2" class="data row9 col2">True</td>
</tr>
<tr class="odd">
<td id="T_8329e_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">10</td>
<td id="T_8329e_row10_col0" class="data row10 col0">Xbox</td>
<td id="T_8329e_row10_col1" class="data row10 col1">0.009724</td>
<td id="T_8329e_row10_col2" class="data row10 col2">True</td>
</tr>
<tr class="even">
<td id="T_8329e_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">11</td>
<td id="T_8329e_row11_col0" class="data row11 col0">Nokia</td>
<td id="T_8329e_row11_col1" class="data row11 col1">0.001080</td>
<td id="T_8329e_row11_col2" class="data row11 col2">True</td>
</tr>
<tr class="odd">
<td id="T_8329e_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">12</td>
<td id="T_8329e_row12_col0" class="data row12 col0">FreeBSD</td>
<td id="T_8329e_row12_col1" class="data row12 col1">0.001080</td>
<td id="T_8329e_row12_col2" class="data row12 col2">True</td>
</tr>
<tr class="even">
<td id="T_8329e_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">13</td>
<td id="T_8329e_row13_col0" class="data row13 col0">Samsung</td>
<td id="T_8329e_row13_col1" class="data row13 col1">0.001080</td>
<td id="T_8329e_row13_col2" class="data row13 col2">True</td>
</tr>
<tr class="odd">
<td id="T_8329e_level0_row14" class="row_heading level0 row14" data-quarto-table-cell-role="th">14</td>
<td id="T_8329e_row14_col0" class="data row14 col0">SunOS</td>
<td id="T_8329e_row14_col1" class="data row14 col1">0.001080</td>
<td id="T_8329e_row14_col2" class="data row14 col2">True</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<style type="text/css">
#T_fdadf_row0_col1, #T_fdadf_row1_col1 {
  background-color: yellow;
}
#T_fdadf_row2_col1 {
  background-color: antiquewhite;
}
</style>

<table id="T_fdadf" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_fdadf_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">deviceCategory</th>
<th id="T_fdadf_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">proportion</th>
<th id="T_fdadf_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">showing_all_cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_fdadf_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_fdadf_row0_col0" class="data row0 col0">desktop</td>
<td id="T_fdadf_row0_col1" class="data row0 col1">72.776091</td>
<td id="T_fdadf_row0_col2" class="data row0 col2">True</td>
</tr>
<tr class="even">
<td id="T_fdadf_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_fdadf_row1_col0" class="data row1 col0">mobile</td>
<td id="T_fdadf_row1_col1" class="data row1 col1">23.543776</td>
<td id="T_fdadf_row1_col2" class="data row1 col2">True</td>
</tr>
<tr class="odd">
<td id="T_fdadf_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_fdadf_row2_col0" class="data row2 col0">tablet</td>
<td id="T_fdadf_row2_col1" class="data row2 col1">3.680133</td>
<td id="T_fdadf_row2_col2" class="data row2 col2">True</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Each of the top two to four categories account for &gt;10% of observations (visitors) in all nine of the categorical features. Four (<code>channelGrouping</code>, <code>os</code>, <code>medium</code> and <code>last_action</code>) of the nine categorical features have categories that occur with a frequency of between 5 - 10%. Based on the training data, a minimum required frequency of 10% appears to be a reasonable starting point for replacing infrequently occurring categories.</li>
</ol>
</div>
</div>
</section>
<section id="distribution-of-numerical-features" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-numerical-features">Distribution of Numerical Features</h3>
<div class="cell" data-tags="[]" data-execution_count="27">
<div class="cell-output cell-output-display">
<p><img src="04_train_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>For numerical features among return visitors who did not make a purchase
<ul>
<li>there is a wider range of outliers</li>
<li>the IQR range (height of the box) is more well-defined (smaller)</li>
<li>average value (horizontal line inside the box) is generally higher</li>
</ul>
than for the same features among those visitors who did.</li>
<li>Based on univariate analaysis, the overall numerical features contain approximately 8-11% of outliers. <em>promotions clicked</em> is the only feature with more outliers (15%).</li>
</ol>
</div>
</div>
</section>
<section id="conversion-rates-among-categorical-features" class="level3">
<h3 class="anchored" data-anchor-id="conversion-rates-among-categorical-features">Conversion Rates Among Categorical Features</h3>
<div class="cell" data-tags="[]" data-execution_count="28">
<div class="cell-output cell-output-display">
<p><img src="04_train_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>(<code>bounces</code>) A smaller fraction of return purchasers bounced off the page than for non-return purchasers. It seems keeping visitors engaged during their first visit is a good indicator for getting their business during a return visit to the store.</li>
<li>(<code>desktop</code>) The largest fraction of return purchasers used a desktop computer during their first visit. This dataset captures visitors from as early as August 2016 to as late as August 2017. With increased mobile phone use since then, these proportions might have changed since then.</li>
<li>(<code>operating system</code>) The largest fraction of return purchasers used a desktop (Mac, Windows and Linux) to access the store during their first visit. This is not surprising based on the above observation about the high fraction desktop use among return purcasers.</li>
<li>(<code>browser</code>) Chrome was the dominant browser, ahead of a grouping of Safari and Firefox. The Microsoft Edge browser was only <a href="https://en.wikipedia.org/wiki/Microsoft_Edge">released in July 2015</a>, so it not surprising that Edge is a little further back from Safari and Firefox.</li>
<li>(<code>channel</code>, <code>medium</code> and <code>source</code>) Based on source, medium and channel, return purchasers
<ul>
<li>directly accessed the store’s site (<a href="https://www.ruleranalytics.com/blog/analytics/direct-traffic-google-analytics/">manually typed in the URL of the store</a>)
<ul>
<li>medium=<code>None</code></li>
<li>channel=<code>Direct</code></li>
<li>source=<code>(direct)</code></li>
</ul></li>
<li>relied on referrals (visitor clicked a link to the store on another site - <a href="https://support.google.com/analytics/answer/3297892?hl=en">1</a>, <a href="https://www.jellyfish.com/en-us/training/blog/google-analytics-channels-explained">2</a>)
<ul>
<li>channel=<code>Referral</code></li>
<li>medium=<code>Referral</code></li>
</ul></li>
<li>accessed the store site by <a href="https://blog.hubspot.com/marketing/organic-search-definition-100-words">clicking on a link from a non-paid search result in a search engine</a>
<ul>
<li>channel=<code>Organic Search</code></li>
<li>medium=<code>organic</code></li>
</ul>
during their first visit. From the chart for the <code>source</code> feature, we see that the dominant search engine (contributing to the organic search results) is Google Search.</li>
</ul></li>
<li>(<code>last action</code>) Qualitatively, the largest <strong>fraction</strong> (ratio of red bar to grey bar) of return purchasers
<ul>
<li>checked out</li>
<li>completed a purchase</li>
<li>removed a product from their shopping cart</li>
</ul>
as the last action during their first visit to the store. The largest <strong>number</strong> (length of red bar) of return purchasers
<ul>
<li>performed an action that could not be tracked by the embedded Google Analytics tracking script</li>
<li>viewed product details</li>
<li>added a product to their shopping cart</li>
</ul>
as the last action during their first visit to the store.</li>
</ol>
</div>
</div>
</section>
<section id="numerical-feature-interactions" class="level3">
<h3 class="anchored" data-anchor-id="numerical-feature-interactions">Numerical Feature Interactions</h3>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Slow Execution
</div>
</div>
<div class="callout-body-container callout-body">
<p>As the length of the data grows (as more months of training data are used), it takes longer to retrieve feature interactions.</p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="29">
<div class="cell-output cell-output-stderr">
<pre><code>/opt/conda/envs/train/lib/python3.11/site-packages/seaborn/axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="04_train_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Inter-feature correlations are observed between hits and product clicks or between hits and page views. Qualitatively, the other feature interactions do not show evidence of a correlation.</li>
</ol>
</div>
</div>
</section>
</section>
<section id="ml-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="ml-pipeline">ML Pipeline</h2>
<p>As indicated in the EDA section, all non-ID features will be passed into the ML pipeline. The ML pipeline will first perform feature engineering and preprocessing. This step is named <code>preprocessor</code>. The next step of the pipeline (named <code>select</code>) will select features based on feature-to-feature correlations.</p>
<section id="feature-selection---sql" class="level3">
<h3 class="anchored" data-anchor-id="feature-selection---sql">Feature Selection - SQL</h3>
<p>Several features were selected extracted from the raw GA360 data using BigQuery SQL. These features were selected based on intuition about factors that would be helpful to predict future (return) visit propensity.</p>
</section>
<section id="feature-selection---python" class="level3">
<h3 class="anchored" data-anchor-id="feature-selection---python">Feature Selection - Python</h3>
<p>Highly correlated features will be dropped and all remaining features (low or moderately correlated to eachother) will be selected.</p>
</section>
<section id="feature-engineering---sql" class="level3">
<h3 class="anchored" data-anchor-id="feature-engineering---sql">Feature Engineering - SQL</h3>
<p>As part of the data retrieval from the Google Analytics tracking data for the merchandise store’s site, the following features of the first visit were engineered using SQL</p>
<ol type="1">
<li><code>last_action</code>
<ul>
<li>last action performed during the first visit</li>
</ul></li>
<li><code>added_to_cart</code>
<ul>
<li>number of products added to shopping cart during the first visit</li>
</ul></li>
</ol>
<p>All other features were extracted directly from the raw GA360 data, without being engineered.</p>
</section>
<section id="feature-engineering---python" class="level3">
<h3 class="anchored" data-anchor-id="feature-engineering---python">Feature Engineering - Python</h3>
<p>Feature engineering is performed on the raw data, before pre-processing. For each numerical feature, we’ll extract three new features as the ratio to the mean. The intuition behind this transformation is that visitors with a higher-than-average number of pages viewed on their first visit have a higher likelihood of making a purchase on a return visit. This is implemented in <code>src/feature_helpers.py</code> using a <code>scikit-learn</code> <a href="https://scikit-learn.org/stable/modules/preprocessing.html#custom-transformers">custom transformer</a>.</p>
</section>
<section id="feature-pre-processing" class="level3">
<h3 class="anchored" data-anchor-id="feature-pre-processing">Feature Pre-Processing</h3>
<p>A feature processing pipeline is defined with the following steps</p>
<ol type="1">
<li>numerical columns
<ul>
<li>feature engineering</li>
<li>normalization</li>
</ul></li>
<li>categorical columns
<ul>
<li>frequency encoding</li>
<li>dummy encoding</li>
</ul></li>
<li>feature selection
<ul>
<li>drop highly correlated features (r &gt; 0.7)</li>
<li>keep weakly (r &lt; 0.5) and moderately (r &gt; 0.5 and r &lt; 0.7) corelated features</li>
</ul></li>
</ol>
</section>
<section id="pipeline" class="level3">
<h3 class="anchored" data-anchor-id="pipeline">Pipeline</h3>
<p>In the overall ML pipeline, preprocessing is performed in combination with under-sampling or over-sampling in order to handle the class imbalance. If the observations are undersampled, then this is done before preprocessing features. By comparison , if they are oversampled, then this is done after preprocessing features.</p>
<p>After preprocessing, the class-imbalance increases in favor of the minority class. The class imbalances can be the same after preprocessing using under- and over-sampling. The <code>sampling_strategy</code> hyperparameter determines the imbalance in the label after resampling. If hyperparameter is the same for over- and under-sampling then both approaches produce the same class imbalance after resampling. For this reason, equal class imbalances is possible with both approaches. With the same <code>sampling_strategy</code> hyperparameter, the number of remaining observations after resampling can be different depending on whether under- or over-sampling is used, since both resampling approaches work differently.</p>
<p>Over-sampling adds more observations in the minority class and so there are more observations in this class after over-sampling. For under-sampling, the number of such minority-class observations are unchanged, since observations are removed from the majority class.</p>
<div class="cell" data-tags="[]" data-execution_count="30">
<div class="cell-output cell-output-display" data-execution_count="30">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                                                     'last_action',
                                                                                                     'source',
                                                                                                     'medium',
                                                                                                     'channelGrouping',
                                                                                                     'browser',
                                                                                                     'os',
                                                                                                     'deviceCategory'])])),
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures()),
                ('resampler', RandomOverSampler(random_state=88))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                                                     'last_action',
                                                                                                     'source',
                                                                                                     'medium',
                                                                                                     'channelGrouping',
                                                                                                     'browser',
                                                                                                     'os',
                                                                                                     'deviceCategory'])])),
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures()),
                ('resampler', RandomOverSampler(random_state=88))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('num',
                                 Pipeline(steps=[('aboveavg',
                                                  AboveAveragePagePromoEngager(cols=['hits',
                                                                                     'promos_displayed',
                                                                                     'promos_clicked',
                                                                                     'product_views',
                                                                                     'product_clicks',
                                                                                     'pageviews',
                                                                                     'time_on_site'])),
                                                 ('scaler', MinMaxScaler())]),
                                 ['hits', 'promos_displayed', 'promos_clicked',
                                  'product_views', 'product_clicks',
                                  'pageviews', 'time_on_site']),
                                ('cat',
                                 P...
                                                  ColumnTransformer(remainder='passthrough',
                                                                    transformers=[('fe',
                                                                                   RareLabelEncoder(variables=['source',
                                                                                                               'browser']),
                                                                                   ['bounces',
                                                                                    'last_action',
                                                                                    'source',
                                                                                    'medium',
                                                                                    'channelGrouping',
                                                                                    'browser',
                                                                                    'os',
                                                                                    'deviceCategory'])])),
                                                 ('dummy',
                                                  OneHotEncoder(drop='first',
                                                                dtype=&lt;class 'int'&gt;,
                                                                handle_unknown='ignore'))]),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>['hits', 'promos_displayed', 'promos_clicked', 'product_views', 'product_clicks', 'pageviews', 'time_on_site']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">AboveAveragePagePromoEngager</label><div class="sk-toggleable__content"><pre>AboveAveragePagePromoEngager(cols=['hits', 'promos_displayed', 'promos_clicked',
                                   'product_views', 'product_clicks',
                                   'pageviews', 'time_on_site'])</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">MinMaxScaler</label><div class="sk-toggleable__content"><pre>MinMaxScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">rarecats: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder='passthrough',
                  transformers=[('fe',
                                 RareLabelEncoder(variables=['source',
                                                             'browser']),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">fe</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox"><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">RareLabelEncoder</label><div class="sk-toggleable__content"><pre>RareLabelEncoder(variables=['source', 'browser'])</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox"><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre></pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox"><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox"><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop='first', dtype=&lt;class 'int'&gt;, handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox"><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">DropCorrelatedFeatures</label><div class="sk-toggleable__content"><pre>DropCorrelatedFeatures()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox"><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">RandomOverSampler</label><div class="sk-toggleable__content"><pre>RandomOverSampler(random_state=88)</pre></div></div></div></div></div></div></div>
</div>
</div>
</section>
</section>
<section id="model-development" class="level2">
<h2 class="anchored" data-anchor-id="model-development">Model Development</h2>
<section id="define-cross-validator" class="level3">
<h3 class="anchored" data-anchor-id="define-cross-validator">Define Cross-Validator</h3>
<p>A single validation fold (the validation data split) is used to validate the ML pipeline. A cross-validator is defined using <code>sklearn</code>’s <code>PredefinedSplit</code> to train the pipeline on the training data split and evaluate predictions on the validation data split.</p>
</section>
<section id="append-ml-model-to-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="append-ml-model-to-pipeline">Append ML Model to Pipeline</h3>
<div class="cell" data-tags="[]" data-execution_count="33">
<div class="cell-output cell-output-display" data-execution_count="33">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                                                     'channelGrouping',
                                                                                                     'browser',
                                                                                                     'os',
                                                                                                     'deviceCategory'])])),
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures()),
                ('resampler', RandomOverSampler(random_state=88)),
                ['clf', BetaDistClassifier(random_state=88)]])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-15" type="checkbox"><label for="sk-estimator-id-15" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                                                     'channelGrouping',
                                                                                                     'browser',
                                                                                                     'os',
                                                                                                     'deviceCategory'])])),
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures()),
                ('resampler', RandomOverSampler(random_state=88)),
                ['clf', BetaDistClassifier(random_state=88)]])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-16" type="checkbox"><label for="sk-estimator-id-16" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('num',
                                 Pipeline(steps=[('aboveavg',
                                                  AboveAveragePagePromoEngager(cols=['hits',
                                                                                     'promos_displayed',
                                                                                     'promos_clicked',
                                                                                     'product_views',
                                                                                     'product_clicks',
                                                                                     'pageviews',
                                                                                     'time_on_site'])),
                                                 ('scaler', MinMaxScaler())]),
                                 ['hits', 'promos_displayed', 'promos_clicked',
                                  'product_views', 'product_clicks',
                                  'pageviews', 'time_on_site']),
                                ('cat',
                                 P...
                                                  ColumnTransformer(remainder='passthrough',
                                                                    transformers=[('fe',
                                                                                   RareLabelEncoder(variables=['source',
                                                                                                               'browser']),
                                                                                   ['bounces',
                                                                                    'last_action',
                                                                                    'source',
                                                                                    'medium',
                                                                                    'channelGrouping',
                                                                                    'browser',
                                                                                    'os',
                                                                                    'deviceCategory'])])),
                                                 ('dummy',
                                                  OneHotEncoder(drop='first',
                                                                dtype=&lt;class 'int'&gt;,
                                                                handle_unknown='ignore'))]),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox"><label for="sk-estimator-id-17" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>['hits', 'promos_displayed', 'promos_clicked', 'product_views', 'product_clicks', 'pageviews', 'time_on_site']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox"><label for="sk-estimator-id-18" class="sk-toggleable__label sk-toggleable__label-arrow">AboveAveragePagePromoEngager</label><div class="sk-toggleable__content"><pre>AboveAveragePagePromoEngager(cols=['hits', 'promos_displayed', 'promos_clicked',
                                   'product_views', 'product_clicks',
                                   'pageviews', 'time_on_site'])</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox"><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">MinMaxScaler</label><div class="sk-toggleable__content"><pre>MinMaxScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox"><label for="sk-estimator-id-20" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox"><label for="sk-estimator-id-21" class="sk-toggleable__label sk-toggleable__label-arrow">rarecats: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder='passthrough',
                  transformers=[('fe',
                                 RareLabelEncoder(variables=['source',
                                                             'browser']),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox"><label for="sk-estimator-id-22" class="sk-toggleable__label sk-toggleable__label-arrow">fe</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox"><label for="sk-estimator-id-23" class="sk-toggleable__label sk-toggleable__label-arrow">RareLabelEncoder</label><div class="sk-toggleable__content"><pre>RareLabelEncoder(variables=['source', 'browser'])</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox"><label for="sk-estimator-id-24" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre></pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-25" type="checkbox"><label for="sk-estimator-id-25" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-26" type="checkbox"><label for="sk-estimator-id-26" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop='first', dtype=&lt;class 'int'&gt;, handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox"><label for="sk-estimator-id-27" class="sk-toggleable__label sk-toggleable__label-arrow">DropCorrelatedFeatures</label><div class="sk-toggleable__content"><pre>DropCorrelatedFeatures()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox"><label for="sk-estimator-id-28" class="sk-toggleable__label sk-toggleable__label-arrow">RandomOverSampler</label><div class="sk-toggleable__content"><pre>RandomOverSampler(random_state=88)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox"><label for="sk-estimator-id-29" class="sk-toggleable__label sk-toggleable__label-arrow">BetaDistClassifier</label><div class="sk-toggleable__content"><pre>BetaDistClassifier(random_state=88)</pre></div></div></div></div></div></div></div>
</div>
</div>
</section>
<section id="hyper-parameter-tuning" class="level3">
<h3 class="anchored" data-anchor-id="hyper-parameter-tuning">Hyper-Parameter Tuning</h3>
<p>Perform hyper-parameter tuning</p>
<div class="cell" data-tags="[]" data-execution_count="35">
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 1 folds for each of 30 candidates, totalling 30 fits
[CV] END clf__a=0.2, clf__b=2.31, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.2, clf__b=2.25, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.2, clf__b=2.35, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.2, clf__b=2.4, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.2, clf__b=2.5, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.3, clf__b=2.31, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.3, clf__b=2.25, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.3, clf__b=2.35, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.3, clf__b=2.4, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.3, clf__b=2.5, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.4, clf__b=2.31, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.4, clf__b=2.25, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.4, clf__b=2.35, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.4, clf__b=2.4, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.4, clf__b=2.5, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.35, clf__b=2.31, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.35, clf__b=2.25, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.35, clf__b=2.35, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.35, clf__b=2.4, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.35, clf__b=2.5, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.15, clf__b=2.31, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.15, clf__b=2.25, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.15, clf__b=2.35, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.15, clf__b=2.4, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.15, clf__b=2.5, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.45, clf__b=2.31, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.45, clf__b=2.25, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.45, clf__b=2.35, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
[CV] END clf__a=0.45, clf__b=2.4, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.1s
[CV] END clf__a=0.45, clf__b=2.5, preprocessor__cat__rarecats__fe__ignore_format=True, preprocessor__cat__rarecats__fe__n_categories=1, preprocessor__cat__rarecats__fe__replace_with=other, preprocessor__cat__rarecats__fe__tol=0.1, resampler__sampling_strategy=0.1, select__threshold=0.7; total time=   1.0s
Done with hyperparameter tuning
CPU times: user 29.4 s, sys: 1.21 s, total: 30.6 s
Wall time: 30.6 s</code></pre>
</div>
</div>
</section>
<section id="get-validation-hyper-parameters-and-metrics" class="level3">
<h3 class="anchored" data-anchor-id="get-validation-hyper-parameters-and-metrics">Get Validation Hyper-Parameters and Metrics</h3>
<div class="cell" data-tags="[]" data-execution_count="36">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">resampling_approach</th>
<th data-quarto-table-cell-role="th">clf</th>
<th data-quarto-table-cell-role="th">param_clf__a</th>
<th data-quarto-table-cell-role="th">param_clf__b</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__ignore_format</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__n_categories</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__replace_with</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__tol</th>
<th data-quarto-table-cell-role="th">param_resampler__sampling_strategy</th>
<th data-quarto-table-cell-role="th">param_select__threshold</th>
<th data-quarto-table-cell-role="th">mean_test_accuracy</th>
<th data-quarto-table-cell-role="th">mean_test_balanced_accuracy</th>
<th data-quarto-table-cell-role="th">mean_test_precision</th>
<th data-quarto-table-cell-role="th">mean_test_recall</th>
<th data-quarto-table-cell-role="th">mean_test_roc_auc</th>
<th data-quarto-table-cell-role="th">mean_test_f1</th>
<th data-quarto-table-cell-role="th">mean_test_fbeta05</th>
<th data-quarto-table-cell-role="th">mean_test_fbeta2</th>
<th data-quarto-table-cell-role="th">mean_test_pr_auc</th>
<th data-quarto-table-cell-role="th">mean_test_avg_precision</th>
<th data-quarto-table-cell-role="th">mean_fit_time</th>
<th data-quarto-table-cell-role="th">mean_score_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.937338</td>
<td>0.497237</td>
<td>0.4969</td>
<td>0.497237</td>
<td>0.497237</td>
<td>0.49702</td>
<td>0.496935</td>
<td>0.497139</td>
<td>0.035248</td>
<td>0.033944</td>
<td>0.838606</td>
<td>0.129285</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.936015</td>
<td>0.499893</td>
<td>0.499886</td>
<td>0.499893</td>
<td>0.499893</td>
<td>0.499873</td>
<td>0.499877</td>
<td>0.499881</td>
<td>0.034241</td>
<td>0.034087</td>
<td>0.833808</td>
<td>0.128262</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.938518</td>
<td>0.497848</td>
<td>0.497491</td>
<td>0.497848</td>
<td>0.497848</td>
<td>0.497581</td>
<td>0.497503</td>
<td>0.497722</td>
<td>0.033957</td>
<td>0.033972</td>
<td>0.833164</td>
<td>0.128603</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.940171</td>
<td>0.501376</td>
<td>0.501676</td>
<td>0.501376</td>
<td>0.501376</td>
<td>0.501346</td>
<td>0.501493</td>
<td>0.501327</td>
<td>0.033844</td>
<td>0.034193</td>
<td>0.833534</td>
<td>0.128049</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.941871</td>
<td>0.494907</td>
<td>0.493139</td>
<td>0.494907</td>
<td>0.494907</td>
<td>0.493804</td>
<td>0.493339</td>
<td>0.494424</td>
<td>0.033918</td>
<td>0.03389</td>
<td>0.840209</td>
<td>0.131298</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.919677</td>
<td>0.49678</td>
<td>0.497731</td>
<td>0.49678</td>
<td>0.49678</td>
<td>0.496631</td>
<td>0.497178</td>
<td>0.496524</td>
<td>0.033115</td>
<td>0.033908</td>
<td>0.833161</td>
<td>0.128464</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.91741</td>
<td>0.498947</td>
<td>0.499295</td>
<td>0.498947</td>
<td>0.498947</td>
<td>0.498194</td>
<td>0.498695</td>
<td>0.498343</td>
<td>0.035372</td>
<td>0.034027</td>
<td>0.832108</td>
<td>0.128794</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.921188</td>
<td>0.497562</td>
<td>0.498231</td>
<td>0.497562</td>
<td>0.497562</td>
<td>0.497366</td>
<td>0.497787</td>
<td>0.497321</td>
<td>0.033669</td>
<td>0.033949</td>
<td>0.832933</td>
<td>0.128291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.924257</td>
<td>0.501155</td>
<td>0.500888</td>
<td>0.501155</td>
<td>0.501155</td>
<td>0.500621</td>
<td>0.500704</td>
<td>0.500823</td>
<td>0.034409</td>
<td>0.034173</td>
<td>0.838171</td>
<td>0.128922</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.926524</td>
<td>0.491639</td>
<td>0.493011</td>
<td>0.491639</td>
<td>0.491639</td>
<td>0.49222</td>
<td>0.492673</td>
<td>0.491843</td>
<td>0.03451</td>
<td>0.033759</td>
<td>0.834019</td>
<td>0.130571</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.906077</td>
<td>0.506442</td>
<td>0.503485</td>
<td>0.506442</td>
<td>0.506442</td>
<td>0.501948</td>
<td>0.502437</td>
<td>0.503494</td>
<td>0.037157</td>
<td>0.034599</td>
<td>0.846922</td>
<td>0.130414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.901591</td>
<td>0.502784</td>
<td>0.501419</td>
<td>0.502784</td>
<td>0.502784</td>
<td>0.49869</td>
<td>0.499861</td>
<td>0.499794</td>
<td>0.034884</td>
<td>0.034291</td>
<td>0.833361</td>
<td>0.130111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.907541</td>
<td>0.499851</td>
<td>0.499916</td>
<td>0.499851</td>
<td>0.499851</td>
<td>0.497683</td>
<td>0.498696</td>
<td>0.498168</td>
<td>0.034046</td>
<td>0.034084</td>
<td>0.832757</td>
<td>0.129887</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.910658</td>
<td>0.504136</td>
<td>0.50242</td>
<td>0.504136</td>
<td>0.504136</td>
<td>0.501186</td>
<td>0.501605</td>
<td>0.502202</td>
<td>0.03413</td>
<td>0.034402</td>
<td>0.833543</td>
<td>0.129507</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.915191</td>
<td>0.507151</td>
<td>0.504497</td>
<td>0.507151</td>
<td>0.507151</td>
<td>0.504175</td>
<td>0.5041</td>
<td>0.505396</td>
<td>0.034229</td>
<td>0.034682</td>
<td>0.834943</td>
<td>0.128881</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.914105</td>
<td>0.503249</td>
<td>0.502022</td>
<td>0.503249</td>
<td>0.503249</td>
<td>0.501085</td>
<td>0.501396</td>
<td>0.501849</td>
<td>0.035325</td>
<td>0.034332</td>
<td>0.847951</td>
<td>0.129791</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.910469</td>
<td>0.498694</td>
<td>0.499229</td>
<td>0.498694</td>
<td>0.498694</td>
<td>0.497249</td>
<td>0.498171</td>
<td>0.497504</td>
<td>0.034268</td>
<td>0.034011</td>
<td>0.833749</td>
<td>0.129239</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.91538</td>
<td>0.500568</td>
<td>0.500364</td>
<td>0.500568</td>
<td>0.500568</td>
<td>0.499234</td>
<td>0.499707</td>
<td>0.499619</td>
<td>0.033771</td>
<td>0.034132</td>
<td>0.834563</td>
<td>0.129044</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.917363</td>
<td>0.500259</td>
<td>0.500172</td>
<td>0.500259</td>
<td>0.500259</td>
<td>0.49922</td>
<td>0.499621</td>
<td>0.499517</td>
<td>0.03199</td>
<td>0.034111</td>
<td>0.836857</td>
<td>0.131658</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.920905</td>
<td>0.497415</td>
<td>0.498135</td>
<td>0.497415</td>
<td>0.497415</td>
<td>0.497227</td>
<td>0.497671</td>
<td>0.497171</td>
<td>0.032392</td>
<td>0.033941</td>
<td>0.838040</td>
<td>0.128754</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.944374</td>
<td>0.498875</td>
<td>0.498347</td>
<td>0.498875</td>
<td>0.498875</td>
<td>0.498102</td>
<td>0.498085</td>
<td>0.498477</td>
<td>0.034448</td>
<td>0.034026</td>
<td>0.842462</td>
<td>0.131450</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.942815</td>
<td>0.495396</td>
<td>0.493561</td>
<td>0.495396</td>
<td>0.495396</td>
<td>0.494197</td>
<td>0.493728</td>
<td>0.494864</td>
<td>0.034823</td>
<td>0.033902</td>
<td>0.845299</td>
<td>0.127957</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.945554</td>
<td>0.498818</td>
<td>0.498164</td>
<td>0.498818</td>
<td>0.498818</td>
<td>0.497852</td>
<td>0.497825</td>
<td>0.498325</td>
<td>0.034849</td>
<td>0.034024</td>
<td>0.857142</td>
<td>0.136108</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.946546</td>
<td>0.497995</td>
<td>0.496711</td>
<td>0.497995</td>
<td>0.497995</td>
<td>0.496642</td>
<td>0.496435</td>
<td>0.49734</td>
<td>0.0329</td>
<td>0.033986</td>
<td>0.890077</td>
<td>0.128920</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.948293</td>
<td>0.497563</td>
<td>0.495594</td>
<td>0.497563</td>
<td>0.497563</td>
<td>0.495692</td>
<td>0.495303</td>
<td>0.496684</td>
<td>0.032286</td>
<td>0.033974</td>
<td>0.914942</td>
<td>0.130732</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.895642</td>
<td>0.509057</td>
<td>0.504212</td>
<td>0.509057</td>
<td>0.509057</td>
<td>0.501366</td>
<td>0.50241</td>
<td>0.503753</td>
<td>0.033735</td>
<td>0.034826</td>
<td>0.869662</td>
<td>0.131349</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.891533</td>
<td>0.505594</td>
<td>0.502486</td>
<td>0.505594</td>
<td>0.505594</td>
<td>0.498405</td>
<td>0.500168</td>
<td>0.500268</td>
<td>0.033554</td>
<td>0.034511</td>
<td>0.882437</td>
<td>0.130377</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.897483</td>
<td>0.500657</td>
<td>0.500318</td>
<td>0.500657</td>
<td>0.500657</td>
<td>0.496608</td>
<td>0.498325</td>
<td>0.497445</td>
<td>0.037999</td>
<td>0.034138</td>
<td>0.887902</td>
<td>0.141681</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.901214</td>
<td>0.503256</td>
<td>0.50165</td>
<td>0.503256</td>
<td>0.503256</td>
<td>0.498926</td>
<td>0.50008</td>
<td>0.50012</td>
<td>0.032486</td>
<td>0.034327</td>
<td>0.925393</td>
<td>0.140756</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>0.907447</td>
<td>0.501806</td>
<td>0.501008</td>
<td>0.501806</td>
<td>0.501806</td>
<td>0.499027</td>
<td>0.499864</td>
<td>0.499808</td>
<td>0.03409</td>
<td>0.034219</td>
<td>0.888209</td>
<td>0.137114</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="get-best-hyper-parameters" class="level3">
<h3 class="anchored" data-anchor-id="get-best-hyper-parameters">Get Best Hyper-Parameters</h3>
<div class="cell" data-tags="[]" data-execution_count="37">
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">resampling_approach</th>
<th data-quarto-table-cell-role="th">clf</th>
<th data-quarto-table-cell-role="th">param_clf__a</th>
<th data-quarto-table-cell-role="th">param_clf__b</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__ignore_format</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__n_categories</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__replace_with</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__tol</th>
<th data-quarto-table-cell-role="th">param_resampler__sampling_strategy</th>
<th data-quarto-table-cell-role="th">param_select__threshold</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">mean_test_precision</th>
<th data-quarto-table-cell-role="th">mean_test_recall</th>
<th data-quarto-table-cell-role="th">mean_test_roc_auc</th>
<th data-quarto-table-cell-role="th">mean_test_f1</th>
<th data-quarto-table-cell-role="th">mean_test_fbeta05</th>
<th data-quarto-table-cell-role="th">mean_test_fbeta2</th>
<th data-quarto-table-cell-role="th">mean_test_pr_auc</th>
<th data-quarto-table-cell-role="th">mean_test_avg_precision</th>
<th data-quarto-table-cell-role="th">mean_fit_time</th>
<th data-quarto-table-cell-role="th">mean_score_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>...</td>
<td>0.504497</td>
<td>0.507151</td>
<td>0.507151</td>
<td>0.504175</td>
<td>0.5041</td>
<td>0.505396</td>
<td>0.034229</td>
<td>0.034682</td>
<td>0.834943</td>
<td>0.128881</td>
</tr>
</tbody>
</table>

<p>1 rows × 23 columns</p>
</div>
</div>
</div>
</section>
<section id="set-best-hyper-parameters-in-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="set-best-hyper-parameters-in-pipeline">Set Best Hyper-Parameters in Pipeline</h3>
<p>Set best hyperparameters in new <code>Pipeline</code></p>
<div class="cell" data-tags="[]" data-execution_count="40">
<div class="cell-output cell-output-display" data-execution_count="40">
<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures(threshold=0.7)),
                ('resampler',
                 RandomOverSampler(random_state=88, sampling_strategy=0.1)),
                ['clf', BetaDistClassifier(a=0.4, b=2.5, random_state=88)]])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox"><label for="sk-estimator-id-30" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures(threshold=0.7)),
                ('resampler',
                 RandomOverSampler(random_state=88, sampling_strategy=0.1)),
                ['clf', BetaDistClassifier(a=0.4, b=2.5, random_state=88)]])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-31" type="checkbox"><label for="sk-estimator-id-31" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('num',
                                 Pipeline(steps=[('aboveavg',
                                                  AboveAveragePagePromoEngager(cols=['hits',
                                                                                     'promos_displayed',
                                                                                     'promos_clicked',
                                                                                     'product_views',
                                                                                     'product_clicks',
                                                                                     'pageviews',
                                                                                     'time_on_site'])),
                                                 ('scaler', MinMaxScaler())]),
                                 ['hits', 'promos_displayed', 'promos_clicked',
                                  'product_views', 'product_clicks',
                                  'pageviews', 'time_on_site']),
                                ('cat',
                                 P...
                                                                                                    n_categories=1,
                                                                                                    replace_with='other',
                                                                                                    tol=0.1,
                                                                                                    variables=['source',
                                                                                                               'browser']),
                                                                                   ['bounces',
                                                                                    'last_action',
                                                                                    'source',
                                                                                    'medium',
                                                                                    'channelGrouping',
                                                                                    'browser',
                                                                                    'os',
                                                                                    'deviceCategory'])])),
                                                 ('dummy',
                                                  OneHotEncoder(drop='first',
                                                                dtype=&lt;class 'int'&gt;,
                                                                handle_unknown='ignore'))]),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-32" type="checkbox"><label for="sk-estimator-id-32" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>['hits', 'promos_displayed', 'promos_clicked', 'product_views', 'product_clicks', 'pageviews', 'time_on_site']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-33" type="checkbox"><label for="sk-estimator-id-33" class="sk-toggleable__label sk-toggleable__label-arrow">AboveAveragePagePromoEngager</label><div class="sk-toggleable__content"><pre>AboveAveragePagePromoEngager(cols=['hits', 'promos_displayed', 'promos_clicked',
                                   'product_views', 'product_clicks',
                                   'pageviews', 'time_on_site'])</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-34" type="checkbox"><label for="sk-estimator-id-34" class="sk-toggleable__label sk-toggleable__label-arrow">MinMaxScaler</label><div class="sk-toggleable__content"><pre>MinMaxScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-35" type="checkbox"><label for="sk-estimator-id-35" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-36" type="checkbox"><label for="sk-estimator-id-36" class="sk-toggleable__label sk-toggleable__label-arrow">rarecats: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder='passthrough',
                  transformers=[('fe',
                                 RareLabelEncoder(ignore_format=True,
                                                  n_categories=1,
                                                  replace_with='other', tol=0.1,
                                                  variables=['source',
                                                             'browser']),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-37" type="checkbox"><label for="sk-estimator-id-37" class="sk-toggleable__label sk-toggleable__label-arrow">fe</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-38" type="checkbox"><label for="sk-estimator-id-38" class="sk-toggleable__label sk-toggleable__label-arrow">RareLabelEncoder</label><div class="sk-toggleable__content"><pre>RareLabelEncoder(ignore_format=True, n_categories=1, replace_with='other',
                 tol=0.1, variables=['source', 'browser'])</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-39" type="checkbox"><label for="sk-estimator-id-39" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre></pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-40" type="checkbox"><label for="sk-estimator-id-40" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-41" type="checkbox"><label for="sk-estimator-id-41" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop='first', dtype=&lt;class 'int'&gt;, handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-42" type="checkbox"><label for="sk-estimator-id-42" class="sk-toggleable__label sk-toggleable__label-arrow">DropCorrelatedFeatures</label><div class="sk-toggleable__content"><pre>DropCorrelatedFeatures(threshold=0.7)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-43" type="checkbox"><label for="sk-estimator-id-43" class="sk-toggleable__label sk-toggleable__label-arrow">RandomOverSampler</label><div class="sk-toggleable__content"><pre>RandomOverSampler(random_state=88, sampling_strategy=0.1)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-44" type="checkbox"><label for="sk-estimator-id-44" class="sk-toggleable__label sk-toggleable__label-arrow">BetaDistClassifier</label><div class="sk-toggleable__content"><pre>BetaDistClassifier(a=0.4, b=2.5, random_state=88)</pre></div></div></div></div></div></div></div>
</div>
</div>
</section>
</section>
<section id="ml-evaluation-1" class="level2">
<h2 class="anchored" data-anchor-id="ml-evaluation-1">ML Evaluation</h2>
<section id="train-best-pipeline-using-combined-and-shuffled-training-and-validation-data" class="level3">
<h3 class="anchored" data-anchor-id="train-best-pipeline-using-combined-and-shuffled-training-and-validation-data">Train Best <code>Pipeline</code> Using Combined and Shuffled Training and Validation Data</h3>
<div class="cell" data-tags="[]" data-execution_count="41">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> pipe.fit(X_train_val_eval, y_train_val_eval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="make-predictions" class="level3">
<h3 class="anchored" data-anchor-id="make-predictions">Make Predictions</h3>
<p><a href="https://ai.stackexchange.com/a/9636">Soft predictions</a></p>
<div class="cell" data-tags="[]" data-execution_count="42">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>y_train_val_eval_pred_proba <span class="op">=</span> pd.DataFrame(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    pipe.predict_proba(X_train_val_eval)[:, <span class="dv">1</span>], index<span class="op">=</span>X_train_val_eval.index</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>).astype(pd.Float32Dtype())</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>y_test_pred_proba <span class="op">=</span> pd.DataFrame(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    pipe.predict_proba(X_test)[:, <span class="dv">1</span>], index<span class="op">=</span>X_test.index</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>).astype(pd.Float32Dtype())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Convert to hard labels, using discrimination threshold of 0.5</p>
<div class="cell" data-tags="[]" data-execution_count="43">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>y_train_val_eval_pred <span class="op">=</span> (y_train_val_eval_pred_proba.squeeze() <span class="op">&gt;=</span> <span class="fl">0.5</span>).astype(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    pd.Int8Dtype()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>y_test_pred <span class="op">=</span> (y_test_pred_proba.squeeze() <span class="op">&gt;=</span> <span class="fl">0.5</span>).astype(pd.Int8Dtype())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-evaluation-metrics" class="level3">
<h3 class="anchored" data-anchor-id="get-evaluation-metrics">Get Evaluation Metrics</h3>
<div class="cell" data-tags="[]" data-execution_count="44">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_ad545_row0_col0, #T_ad545_row1_col0, #T_ad545_row2_col0, #T_ad545_row3_col0, #T_ad545_row4_col0, #T_ad545_row5_col0, #T_ad545_row6_col0, #T_ad545_row7_col0, #T_ad545_row8_col0, #T_ad545_row9_col0 {
  font-size: 14px;
}
#T_ad545_row0_col1, #T_ad545_row0_col2 {
  background-color: #800026;
  color: #f1f1f1;
  font-size: 14px;
}
#T_ad545_row1_col1, #T_ad545_row3_col1, #T_ad545_row4_col1, #T_ad545_row5_col1, #T_ad545_row6_col1, #T_ad545_row7_col1 {
  background-color: #fd7c37;
  color: #f1f1f1;
  font-size: 14px;
}
#T_ad545_row1_col2, #T_ad545_row3_col2, #T_ad545_row4_col2, #T_ad545_row6_col2 {
  background-color: #fd7e38;
  color: #f1f1f1;
  font-size: 14px;
}
#T_ad545_row2_col1, #T_ad545_row2_col2, #T_ad545_row8_col1, #T_ad545_row8_col2, #T_ad545_row9_col1, #T_ad545_row9_col2 {
  background-color: #ffffcc;
  color: #000000;
  font-size: 14px;
}
#T_ad545_row5_col2, #T_ad545_row7_col2 {
  background-color: #fd8038;
  color: #f1f1f1;
  font-size: 14px;
}
</style>

<table id="T_ad545" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th class="index_name level0" data-quarto-table-cell-role="th">split</th>
<th id="T_ad545_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">metric</th>
<th id="T_ad545_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">train_val</th>
<th id="T_ad545_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_ad545_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_ad545_row0_col0" class="data row0 col0">accuracy</td>
<td id="T_ad545_row0_col1" class="data row0 col1">0.905107</td>
<td id="T_ad545_row0_col2" class="data row0 col2">0.923626</td>
</tr>
<tr class="even">
<td id="T_ad545_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_ad545_row1_col0" class="data row1 col0">balanced_accuracy</td>
<td id="T_ad545_row1_col1" class="data row1 col1">0.502320</td>
<td id="T_ad545_row1_col2" class="data row1 col2">0.498962</td>
</tr>
<tr class="odd">
<td id="T_ad545_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_ad545_row2_col0" class="data row2 col0">precision</td>
<td id="T_ad545_row2_col1" class="data row2 col1">0.047152</td>
<td id="T_ad545_row2_col2" class="data row2 col2">0.022222</td>
</tr>
<tr class="even">
<td id="T_ad545_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_ad545_row3_col0" class="data row3 col0">recall</td>
<td id="T_ad545_row3_col1" class="data row3 col1">0.502320</td>
<td id="T_ad545_row3_col2" class="data row3 col2">0.498962</td>
</tr>
<tr class="odd">
<td id="T_ad545_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_ad545_row4_col0" class="data row4 col0">roc_auc</td>
<td id="T_ad545_row4_col1" class="data row4 col1">0.502320</td>
<td id="T_ad545_row4_col2" class="data row4 col2">0.498962</td>
</tr>
<tr class="even">
<td id="T_ad545_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_ad545_row5_col0" class="data row5 col0">f1</td>
<td id="T_ad545_row5_col1" class="data row5 col1">0.501609</td>
<td id="T_ad545_row5_col2" class="data row5 col2">0.495846</td>
</tr>
<tr class="odd">
<td id="T_ad545_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_ad545_row6_col0" class="data row6 col0">fbeta05</td>
<td id="T_ad545_row6_col1" class="data row6 col1">0.501645</td>
<td id="T_ad545_row6_col2" class="data row6 col2">0.497670</td>
</tr>
<tr class="even">
<td id="T_ad545_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_ad545_row7_col0" class="data row7 col0">fbeta2</td>
<td id="T_ad545_row7_col1" class="data row7 col1">0.501902</td>
<td id="T_ad545_row7_col2" class="data row7 col2">0.496202</td>
</tr>
<tr class="odd">
<td id="T_ad545_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_ad545_row8_col0" class="data row8 col0">pr_auc</td>
<td id="T_ad545_row8_col1" class="data row8 col1">0.044149</td>
<td id="T_ad545_row8_col2" class="data row8 col2">0.023794</td>
</tr>
<tr class="even">
<td id="T_ad545_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_ad545_row9_col0" class="data row9 col0">avg_precision</td>
<td id="T_ad545_row9_col1" class="data row9 col1">0.043928</td>
<td id="T_ad545_row9_col2" class="data row9 col2">0.023016</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="optimal-discrimination-threshold-tuning" class="level3">
<h3 class="anchored" data-anchor-id="optimal-discrimination-threshold-tuning">Optimal Discrimination Threshold Tuning</h3>
<p>Discrimination or decision threshold is the probability at which the minority class is chosen over the majority class, when converting soft predictions to hard labels. By default, the threshold is set at 0.5. For imbalanced data, the default threshold of 0.5 can give poor model performance. One possible approach to improving the performance of a model when working with imbalanced data is to vary the discrimination threshold (or <a href="https://machinelearningmastery.com/threshold-moving-for-imbalanced-classification/">threshold tuning</a>), which in-turn varies the sensitivity of the model to false positives, etc. In this way, it is possible to use a brute-force grid search to find the optimal threshold for a particular use-case, based on one or more evaluation metrics.</p>
<p>From varying the threshold using predictions made using the best pipeline, show</p>
<ol type="1">
<li>metrics for default threshold of 0.5</li>
<li>descriptive statistics for metrics as threshold is varied</li>
</ol>
<p>Show a visualization of evaluation metrics relative to the discrimination threshold</p>
<div class="cell" data-tags="[]" data-execution_count="46">
<div class="cell-output cell-output-display">
<p><img src="04_train_files/figure-html/cell-47-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>To be done.</li>
</ol>
</div>
</div>
</section>
<section id="train-best-pipeline-using-all-available-combined-and-shuffled-data" class="level3">
<h3 class="anchored" data-anchor-id="train-best-pipeline-using-all-available-combined-and-shuffled-data">Train Best <code>Pipeline</code> Using All Available Combined and Shuffled Data</h3>
<div class="cell" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> pipe.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-validation-and-evaluation-metrics-feature-metadata-and-observation-metadata" class="level3">
<h3 class="anchored" data-anchor-id="get-validation-and-evaluation-metrics-feature-metadata-and-observation-metadata">Get Validation and Evaluation Metrics, Feature Metadata and Observation Metadata</h3>
<p>Get metrics and metadata for model evaluation</p>
<div class="cell" data-tags="[]" data-execution_count="48">
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">resampling_approach</th>
<th data-quarto-table-cell-role="th">clf</th>
<th data-quarto-table-cell-role="th">param_clf__a</th>
<th data-quarto-table-cell-role="th">param_clf__b</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__ignore_format</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__n_categories</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__replace_with</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__tol</th>
<th data-quarto-table-cell-role="th">param_resampler__sampling_strategy</th>
<th data-quarto-table-cell-role="th">param_select__threshold</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">train_val_f1</th>
<th data-quarto-table-cell-role="th">test_f1</th>
<th data-quarto-table-cell-role="th">train_val_fbeta05</th>
<th data-quarto-table-cell-role="th">test_fbeta05</th>
<th data-quarto-table-cell-role="th">train_val_fbeta2</th>
<th data-quarto-table-cell-role="th">test_fbeta2</th>
<th data-quarto-table-cell-role="th">train_val_pr_auc</th>
<th data-quarto-table-cell-role="th">test_pr_auc</th>
<th data-quarto-table-cell-role="th">train_val_avg_precision</th>
<th data-quarto-table-cell-role="th">test_avg_precision</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>...</td>
<td>0.501609</td>
<td>0.495846</td>
<td>0.501645</td>
<td>0.49767</td>
<td>0.501902</td>
<td>0.496202</td>
<td>0.044149</td>
<td>0.023794</td>
<td>0.043928</td>
<td>0.023016</td>
</tr>
</tbody>
</table>

<p>1 rows × 31 columns</p>
</div>
</div>
</div>
<p>Combine metrics and metadata for model validation and evaluation, and append experiment ID and run ID</p>
<div class="cell" data-tags="[]" data-execution_count="49">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">resampling_approach</th>
<th data-quarto-table-cell-role="th">clf</th>
<th data-quarto-table-cell-role="th">param_clf__a</th>
<th data-quarto-table-cell-role="th">param_clf__b</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__ignore_format</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__n_categories</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__replace_with</th>
<th data-quarto-table-cell-role="th">param_preprocessor__cat__rarecats__fe__tol</th>
<th data-quarto-table-cell-role="th">param_resampler__sampling_strategy</th>
<th data-quarto-table-cell-role="th">param_select__threshold</th>
<th data-quarto-table-cell-role="th">params</th>
<th data-quarto-table-cell-role="th">test_accuracy</th>
<th data-quarto-table-cell-role="th">test_balanced_accuracy</th>
<th data-quarto-table-cell-role="th">test_precision</th>
<th data-quarto-table-cell-role="th">test_recall</th>
<th data-quarto-table-cell-role="th">test_roc_auc</th>
<th data-quarto-table-cell-role="th">test_f1</th>
<th data-quarto-table-cell-role="th">test_fbeta05</th>
<th data-quarto-table-cell-role="th">test_fbeta2</th>
<th data-quarto-table-cell-role="th">test_pr_auc</th>
<th data-quarto-table-cell-role="th">test_avg_precision</th>
<th data-quarto-table-cell-role="th">fit_time</th>
<th data-quarto-table-cell-role="th">score_time</th>
<th data-quarto-table-cell-role="th">experiment_run_type</th>
<th data-quarto-table-cell-role="th">train_val_accuracy</th>
<th data-quarto-table-cell-role="th">train_val_balanced_accuracy</th>
<th data-quarto-table-cell-role="th">train_val_precision</th>
<th data-quarto-table-cell-role="th">train_val_recall</th>
<th data-quarto-table-cell-role="th">train_val_roc_auc</th>
<th data-quarto-table-cell-role="th">train_val_f1</th>
<th data-quarto-table-cell-role="th">train_val_fbeta05</th>
<th data-quarto-table-cell-role="th">train_val_fbeta2</th>
<th data-quarto-table-cell-role="th">train_val_pr_auc</th>
<th data-quarto-table-cell-role="th">train_val_avg_precision</th>
<th data-quarto-table-cell-role="th">train_start_date</th>
<th data-quarto-table-cell-role="th">test_end_date</th>
<th data-quarto-table-cell-role="th">num_observations</th>
<th data-quarto-table-cell-role="th">num_columns</th>
<th data-quarto-table-cell-role="th">column_names</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.2, "clf__b": 2.31, "preprocessor_...</td>
<td>0.937338</td>
<td>0.497237</td>
<td>0.4969</td>
<td>0.497237</td>
<td>0.497237</td>
<td>0.49702</td>
<td>0.496935</td>
<td>0.497139</td>
<td>0.035248</td>
<td>0.033944</td>
<td>0.838606</td>
<td>0.129285</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.2, "clf__b": 2.25, "preprocessor_...</td>
<td>0.936015</td>
<td>0.499893</td>
<td>0.499886</td>
<td>0.499893</td>
<td>0.499893</td>
<td>0.499873</td>
<td>0.499877</td>
<td>0.499881</td>
<td>0.034241</td>
<td>0.034087</td>
<td>0.833808</td>
<td>0.128262</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.2, "clf__b": 2.35, "preprocessor_...</td>
<td>0.938518</td>
<td>0.497848</td>
<td>0.497491</td>
<td>0.497848</td>
<td>0.497848</td>
<td>0.497581</td>
<td>0.497503</td>
<td>0.497722</td>
<td>0.033957</td>
<td>0.033972</td>
<td>0.833164</td>
<td>0.128603</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.2, "clf__b": 2.4, "preprocessor__...</td>
<td>0.940171</td>
<td>0.501376</td>
<td>0.501676</td>
<td>0.501376</td>
<td>0.501376</td>
<td>0.501346</td>
<td>0.501493</td>
<td>0.501327</td>
<td>0.033844</td>
<td>0.034193</td>
<td>0.833534</td>
<td>0.128049</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.2</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.2, "clf__b": 2.5, "preprocessor__...</td>
<td>0.941871</td>
<td>0.494907</td>
<td>0.493139</td>
<td>0.494907</td>
<td>0.494907</td>
<td>0.493804</td>
<td>0.493339</td>
<td>0.494424</td>
<td>0.033918</td>
<td>0.03389</td>
<td>0.840209</td>
<td>0.131298</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.3, "clf__b": 2.31, "preprocessor_...</td>
<td>0.919677</td>
<td>0.49678</td>
<td>0.497731</td>
<td>0.49678</td>
<td>0.49678</td>
<td>0.496631</td>
<td>0.497178</td>
<td>0.496524</td>
<td>0.033115</td>
<td>0.033908</td>
<td>0.833161</td>
<td>0.128464</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.3, "clf__b": 2.25, "preprocessor_...</td>
<td>0.91741</td>
<td>0.498947</td>
<td>0.499295</td>
<td>0.498947</td>
<td>0.498947</td>
<td>0.498194</td>
<td>0.498695</td>
<td>0.498343</td>
<td>0.035372</td>
<td>0.034027</td>
<td>0.832108</td>
<td>0.128794</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.3, "clf__b": 2.35, "preprocessor_...</td>
<td>0.921188</td>
<td>0.497562</td>
<td>0.498231</td>
<td>0.497562</td>
<td>0.497562</td>
<td>0.497366</td>
<td>0.497787</td>
<td>0.497321</td>
<td>0.033669</td>
<td>0.033949</td>
<td>0.832933</td>
<td>0.128291</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.3, "clf__b": 2.4, "preprocessor__...</td>
<td>0.924257</td>
<td>0.501155</td>
<td>0.500888</td>
<td>0.501155</td>
<td>0.501155</td>
<td>0.500621</td>
<td>0.500704</td>
<td>0.500823</td>
<td>0.034409</td>
<td>0.034173</td>
<td>0.838171</td>
<td>0.128922</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.3</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.3, "clf__b": 2.5, "preprocessor__...</td>
<td>0.926524</td>
<td>0.491639</td>
<td>0.493011</td>
<td>0.491639</td>
<td>0.491639</td>
<td>0.49222</td>
<td>0.492673</td>
<td>0.491843</td>
<td>0.03451</td>
<td>0.033759</td>
<td>0.834019</td>
<td>0.130571</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.4, "clf__b": 2.31, "preprocessor_...</td>
<td>0.906077</td>
<td>0.506442</td>
<td>0.503485</td>
<td>0.506442</td>
<td>0.506442</td>
<td>0.501948</td>
<td>0.502437</td>
<td>0.503494</td>
<td>0.037157</td>
<td>0.034599</td>
<td>0.846922</td>
<td>0.130414</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.4, "clf__b": 2.25, "preprocessor_...</td>
<td>0.901591</td>
<td>0.502784</td>
<td>0.501419</td>
<td>0.502784</td>
<td>0.502784</td>
<td>0.49869</td>
<td>0.499861</td>
<td>0.499794</td>
<td>0.034884</td>
<td>0.034291</td>
<td>0.833361</td>
<td>0.130111</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.4, "clf__b": 2.35, "preprocessor_...</td>
<td>0.907541</td>
<td>0.499851</td>
<td>0.499916</td>
<td>0.499851</td>
<td>0.499851</td>
<td>0.497683</td>
<td>0.498696</td>
<td>0.498168</td>
<td>0.034046</td>
<td>0.034084</td>
<td>0.832757</td>
<td>0.129887</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.4, "clf__b": 2.4, "preprocessor__...</td>
<td>0.910658</td>
<td>0.504136</td>
<td>0.50242</td>
<td>0.504136</td>
<td>0.504136</td>
<td>0.501186</td>
<td>0.501605</td>
<td>0.502202</td>
<td>0.03413</td>
<td>0.034402</td>
<td>0.833543</td>
<td>0.129507</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.4, "clf__b": 2.5, "preprocessor__...</td>
<td>0.915191</td>
<td>0.507151</td>
<td>0.504497</td>
<td>0.507151</td>
<td>0.507151</td>
<td>0.504175</td>
<td>0.5041</td>
<td>0.505396</td>
<td>0.034229</td>
<td>0.034682</td>
<td>0.834943</td>
<td>0.128881</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.35, "clf__b": 2.31, "preprocessor...</td>
<td>0.914105</td>
<td>0.503249</td>
<td>0.502022</td>
<td>0.503249</td>
<td>0.503249</td>
<td>0.501085</td>
<td>0.501396</td>
<td>0.501849</td>
<td>0.035325</td>
<td>0.034332</td>
<td>0.847951</td>
<td>0.129791</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.35, "clf__b": 2.25, "preprocessor...</td>
<td>0.910469</td>
<td>0.498694</td>
<td>0.499229</td>
<td>0.498694</td>
<td>0.498694</td>
<td>0.497249</td>
<td>0.498171</td>
<td>0.497504</td>
<td>0.034268</td>
<td>0.034011</td>
<td>0.833749</td>
<td>0.129239</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.35, "clf__b": 2.35, "preprocessor...</td>
<td>0.91538</td>
<td>0.500568</td>
<td>0.500364</td>
<td>0.500568</td>
<td>0.500568</td>
<td>0.499234</td>
<td>0.499707</td>
<td>0.499619</td>
<td>0.033771</td>
<td>0.034132</td>
<td>0.834563</td>
<td>0.129044</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.35, "clf__b": 2.4, "preprocessor_...</td>
<td>0.917363</td>
<td>0.500259</td>
<td>0.500172</td>
<td>0.500259</td>
<td>0.500259</td>
<td>0.49922</td>
<td>0.499621</td>
<td>0.499517</td>
<td>0.03199</td>
<td>0.034111</td>
<td>0.836857</td>
<td>0.131658</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.35</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.35, "clf__b": 2.5, "preprocessor_...</td>
<td>0.920905</td>
<td>0.497415</td>
<td>0.498135</td>
<td>0.497415</td>
<td>0.497415</td>
<td>0.497227</td>
<td>0.497671</td>
<td>0.497171</td>
<td>0.032392</td>
<td>0.033941</td>
<td>0.83804</td>
<td>0.128754</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.15, "clf__b": 2.31, "preprocessor...</td>
<td>0.944374</td>
<td>0.498875</td>
<td>0.498347</td>
<td>0.498875</td>
<td>0.498875</td>
<td>0.498102</td>
<td>0.498085</td>
<td>0.498477</td>
<td>0.034448</td>
<td>0.034026</td>
<td>0.842462</td>
<td>0.13145</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.15, "clf__b": 2.25, "preprocessor...</td>
<td>0.942815</td>
<td>0.495396</td>
<td>0.493561</td>
<td>0.495396</td>
<td>0.495396</td>
<td>0.494197</td>
<td>0.493728</td>
<td>0.494864</td>
<td>0.034823</td>
<td>0.033902</td>
<td>0.845299</td>
<td>0.127957</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.15, "clf__b": 2.35, "preprocessor...</td>
<td>0.945554</td>
<td>0.498818</td>
<td>0.498164</td>
<td>0.498818</td>
<td>0.498818</td>
<td>0.497852</td>
<td>0.497825</td>
<td>0.498325</td>
<td>0.034849</td>
<td>0.034024</td>
<td>0.857142</td>
<td>0.136108</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.15, "clf__b": 2.4, "preprocessor_...</td>
<td>0.946546</td>
<td>0.497995</td>
<td>0.496711</td>
<td>0.497995</td>
<td>0.497995</td>
<td>0.496642</td>
<td>0.496435</td>
<td>0.49734</td>
<td>0.0329</td>
<td>0.033986</td>
<td>0.890077</td>
<td>0.12892</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.15</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.15, "clf__b": 2.5, "preprocessor_...</td>
<td>0.948293</td>
<td>0.497563</td>
<td>0.495594</td>
<td>0.497563</td>
<td>0.497563</td>
<td>0.495692</td>
<td>0.495303</td>
<td>0.496684</td>
<td>0.032286</td>
<td>0.033974</td>
<td>0.914942</td>
<td>0.130732</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.31</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.45, "clf__b": 2.31, "preprocessor...</td>
<td>0.895642</td>
<td>0.509057</td>
<td>0.504212</td>
<td>0.509057</td>
<td>0.509057</td>
<td>0.501366</td>
<td>0.50241</td>
<td>0.503753</td>
<td>0.033735</td>
<td>0.034826</td>
<td>0.869662</td>
<td>0.131349</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.25</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.45, "clf__b": 2.25, "preprocessor...</td>
<td>0.891533</td>
<td>0.505594</td>
<td>0.502486</td>
<td>0.505594</td>
<td>0.505594</td>
<td>0.498405</td>
<td>0.500168</td>
<td>0.500268</td>
<td>0.033554</td>
<td>0.034511</td>
<td>0.882437</td>
<td>0.130377</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.35</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.45, "clf__b": 2.35, "preprocessor...</td>
<td>0.897483</td>
<td>0.500657</td>
<td>0.500318</td>
<td>0.500657</td>
<td>0.500657</td>
<td>0.496608</td>
<td>0.498325</td>
<td>0.497445</td>
<td>0.037999</td>
<td>0.034138</td>
<td>0.887902</td>
<td>0.141681</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.4</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.45, "clf__b": 2.4, "preprocessor_...</td>
<td>0.901214</td>
<td>0.503256</td>
<td>0.50165</td>
<td>0.503256</td>
<td>0.503256</td>
<td>0.498926</td>
<td>0.50008</td>
<td>0.50012</td>
<td>0.032486</td>
<td>0.034327</td>
<td>0.925393</td>
<td>0.140756</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.45</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.45, "clf__b": 2.5, "preprocessor_...</td>
<td>0.907447</td>
<td>0.501806</td>
<td>0.501008</td>
<td>0.501806</td>
<td>0.501806</td>
<td>0.499027</td>
<td>0.499864</td>
<td>0.499808</td>
<td>0.03409</td>
<td>0.034219</td>
<td>0.888209</td>
<td>0.137114</td>
<td>nested</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>os</td>
<td>BetaDistClassifier</td>
<td>0.4</td>
<td>2.5</td>
<td>True</td>
<td>1</td>
<td>other</td>
<td>0.1</td>
<td>0.1</td>
<td>0.7</td>
<td>{"clf__a": 0.4, "clf__b": 2.5, "preprocessor__...</td>
<td>0.923626</td>
<td>0.498962</td>
<td>0.022222</td>
<td>0.498962</td>
<td>0.498962</td>
<td>0.495846</td>
<td>0.49767</td>
<td>0.496202</td>
<td>0.023794</td>
<td>0.023016</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>parent</td>
<td>0.905107</td>
<td>0.50232</td>
<td>0.047152</td>
<td>0.50232</td>
<td>0.50232</td>
<td>0.501609</td>
<td>0.501645</td>
<td>0.501902</td>
<td>0.044149</td>
<td>0.043928</td>
<td>20160901</td>
<td>20170228</td>
<td>113728</td>
<td>29</td>
<td>["fullvisitorid", "visitId", "visitNumber", "v...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="ml-experiment-tracking-1" class="level2">
<h2 class="anchored" data-anchor-id="ml-experiment-tracking-1">ML Experiment Tracking</h2>
<section id="set-up-mlflow-experiment" class="level3">
<h3 class="anchored" data-anchor-id="set-up-mlflow-experiment">Set up MLFlow Experiment</h3>
<div class="cell" data-tags="[]" data-execution_count="53">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> MlflowClient(tracking_uri<span class="op">=</span>mlflow.get_tracking_uri())</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> client.get_experiment_by_name(mlflow_expt_name):</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    experiment_id <span class="op">=</span> client.create_experiment(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        mlflow_expt_name,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        artifact_location<span class="op">=</span>mlflow_artifact_fpath,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        tags<span class="op">=</span>{<span class="st">"version"</span>: <span class="st">"v1"</span>, <span class="st">"priority"</span>: <span class="st">"P1"</span>},</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    client.set_experiment_tag(experiment_id, <span class="st">"demo"</span>, <span class="st">"mydemo"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Created new experiment with ID = </span><span class="sc">{</span>experiment_id<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    experiment_id <span class="op">=</span> client.get_experiment_by_name(mlflow_expt_name).experiment_id</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Retrieved existing experiment with ID = </span><span class="sc">{</span>experiment_id<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="track-experiment-run-outputs-metrics-and-metadata" class="level3">
<h3 class="anchored" data-anchor-id="track-experiment-run-outputs-metrics-and-metadata">Track Experiment Run Outputs (Metrics and Metadata)</h3>
<div class="cell" data-tags="[]" data-execution_count="54">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> mlflow.start_run(experiment_id<span class="op">=</span>experiment_id) <span class="im">as</span> run:</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    run_id <span class="op">=</span> run.info.run_id</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    expt_run_fpath <span class="op">=</span> os.path.join(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        raw_data_dir, <span class="ss">f'ml__run_</span><span class="sc">{</span>run_id<span class="sc">}</span><span class="ss">__expt_</span><span class="sc">{</span>experiment_id<span class="sc">}</span><span class="ss">.parquet.gzip'</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># export validation metrics to file and log as MLFlow artifact</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        df_expt_run_metrics.assign(experiment_id<span class="op">=</span>experiment_id)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        .assign(run_id<span class="op">=</span>run_id)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        .to_parquet(expt_run_fpath, index<span class="op">=</span><span class="va">False</span>, compression<span class="op">=</span><span class="st">'gzip'</span>, engine<span class="op">=</span><span class="st">'pyarrow'</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    mlflow.log_artifact(expt_run_fpath)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Logged metrics and metadata DataFrame as artifact in file "</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>basename(expt_run_fpath)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># export combined processed data to file and log as MLFlow artifact</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    proc_data_fpath <span class="op">=</span> os.path.join(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        processed_data_dir, <span class="ss">f'processed_data__run_</span><span class="sc">{</span>run_id<span class="sc">}</span><span class="ss">__expt_</span><span class="sc">{</span>experiment_id<span class="sc">}</span><span class="ss">.parquet.gzip'</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    df_train_val_eval_test.to_parquet(</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        proc_data_fpath, index<span class="op">=</span><span class="va">False</span>, compression<span class="op">=</span><span class="st">'gzip'</span>, engine<span class="op">=</span><span class="st">'pyarrow'</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    mlflow.log_artifact(proc_data_fpath)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"Logged processed data used during training and evaluation in file "</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>basename(proc_data_fpath)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># export threshold tuning outputs to file and log as MLFlow artifact</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    threshold_data_fpath <span class="op">=</span> os.path.join(</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        processed_data_dir,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'threshold_tuning_data__run_</span><span class="sc">{</span>run_id<span class="sc">}</span><span class="ss">__expt_</span><span class="sc">{</span>experiment_id<span class="sc">}</span><span class="ss">.parquet.gzip'</span>,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    df_thresholds.to_parquet(</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        threshold_data_fpath, index<span class="op">=</span><span class="va">False</span>, compression<span class="op">=</span><span class="st">'gzip'</span>, engine<span class="op">=</span><span class="st">'pyarrow'</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>    mlflow.log_artifact(threshold_data_fpath)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"Logged data from threshold tuning used test data in file "</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>basename(threshold_data_fpath)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># log evaluation metrics</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    mlflow.log_metrics(</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>        df_eval_metrics_metadata.select_dtypes(pd.Float64Dtype()).transpose().to_dict(</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>            orient<span class="op">=</span><span class="st">"dict"</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>        )[<span class="dv">0</span>]</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Logged metrics evaluated against combined train+validation and test data splits"</span>)</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>    curr_datetime <span class="op">=</span> datetime.now().strftime(<span class="st">"%Y%m</span><span class="sc">%d</span><span class="st">_%H%M%S"</span>)</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    model_name <span class="op">=</span> (</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>model_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>train_start_date<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>test_end_date<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>X<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_feats"</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"__</span><span class="sc">{</span>curr_datetime<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> mlflow.sklearn.log_model(</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>        sk_model<span class="op">=</span>pipe,</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>        await_registration_for<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>        artifact_path<span class="op">=</span><span class="st">"model"</span>,</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>        serialization_format<span class="op">=</span><span class="st">'cloudpickle'</span>,</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>        registered_model_name<span class="op">=</span>model_name,</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"Logged best </span><span class="sc">{</span>model_type<span class="sc">}</span><span class="ss"> model (with score of </span><span class="sc">{</span>best_model_eval_score<span class="sc">:.3f}</span><span class="ss">), "</span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>        <span class="st">"after training on all data"</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="non-mlflow-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="non-mlflow-monitoring">Non-MLFlow Monitoring</h3>
<p>Get untrained version of ML <code>Pipeline</code></p>
<div class="cell" data-execution_count="56">
<div class="cell-output cell-output-display" data-execution_count="56">
<style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures(threshold=0.7)),
                ('resampler',
                 RandomOverSampler(random_state=88, sampling_strategy=0.1)),
                ['clf', BetaDistClassifier(a=0.4, b=2.5, random_state=88)]])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-45" type="checkbox"><label for="sk-estimator-id-45" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('aboveavg',
                                                                   AboveAveragePagePromoEngager(cols=['hits',
                                                                                                      'promos_displayed',
                                                                                                      'promos_clicked',
                                                                                                      'product_views',
                                                                                                      'product_clicks',
                                                                                                      'pageviews',
                                                                                                      'time_on_site'])),
                                                                  ('scaler',
                                                                   MinMaxScaler())]),
                                                  ['hits', 'promos_displayed',
                                                   'promos_clicked',
                                                   'product_views',
                                                   'product_clicks',
                                                   'page...
                                                                  ('dummy',
                                                                   OneHotEncoder(drop='first',
                                                                                 dtype=&lt;class 'int'&gt;,
                                                                                 handle_unknown='ignore'))]),
                                                  ['bounces', 'last_action',
                                                   'source', 'medium',
                                                   'channelGrouping', 'browser',
                                                   'os', 'deviceCategory'])])),
                ('select', DropCorrelatedFeatures(threshold=0.7)),
                ('resampler',
                 RandomOverSampler(random_state=88, sampling_strategy=0.1)),
                ['clf', BetaDistClassifier(a=0.4, b=2.5, random_state=88)]])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-46" type="checkbox"><label for="sk-estimator-id-46" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('num',
                                 Pipeline(steps=[('aboveavg',
                                                  AboveAveragePagePromoEngager(cols=['hits',
                                                                                     'promos_displayed',
                                                                                     'promos_clicked',
                                                                                     'product_views',
                                                                                     'product_clicks',
                                                                                     'pageviews',
                                                                                     'time_on_site'])),
                                                 ('scaler', MinMaxScaler())]),
                                 ['hits', 'promos_displayed', 'promos_clicked',
                                  'product_views', 'product_clicks',
                                  'pageviews', 'time_on_site']),
                                ('cat',
                                 P...
                                                                                                    n_categories=1,
                                                                                                    replace_with='other',
                                                                                                    tol=0.1,
                                                                                                    variables=['source',
                                                                                                               'browser']),
                                                                                   ['bounces',
                                                                                    'last_action',
                                                                                    'source',
                                                                                    'medium',
                                                                                    'channelGrouping',
                                                                                    'browser',
                                                                                    'os',
                                                                                    'deviceCategory'])])),
                                                 ('dummy',
                                                  OneHotEncoder(drop='first',
                                                                dtype=&lt;class 'int'&gt;,
                                                                handle_unknown='ignore'))]),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-47" type="checkbox"><label for="sk-estimator-id-47" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>['hits', 'promos_displayed', 'promos_clicked', 'product_views', 'product_clicks', 'pageviews', 'time_on_site']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-48" type="checkbox"><label for="sk-estimator-id-48" class="sk-toggleable__label sk-toggleable__label-arrow">AboveAveragePagePromoEngager</label><div class="sk-toggleable__content"><pre>AboveAveragePagePromoEngager(cols=['hits', 'promos_displayed', 'promos_clicked',
                                   'product_views', 'product_clicks',
                                   'pageviews', 'time_on_site'])</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-49" type="checkbox"><label for="sk-estimator-id-49" class="sk-toggleable__label sk-toggleable__label-arrow">MinMaxScaler</label><div class="sk-toggleable__content"><pre>MinMaxScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-50" type="checkbox"><label for="sk-estimator-id-50" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-51" type="checkbox"><label for="sk-estimator-id-51" class="sk-toggleable__label sk-toggleable__label-arrow">rarecats: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder='passthrough',
                  transformers=[('fe',
                                 RareLabelEncoder(ignore_format=True,
                                                  n_categories=1,
                                                  replace_with='other', tol=0.1,
                                                  variables=['source',
                                                             'browser']),
                                 ['bounces', 'last_action', 'source', 'medium',
                                  'channelGrouping', 'browser', 'os',
                                  'deviceCategory'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-52" type="checkbox"><label for="sk-estimator-id-52" class="sk-toggleable__label sk-toggleable__label-arrow">fe</label><div class="sk-toggleable__content"><pre>['bounces', 'last_action', 'source', 'medium', 'channelGrouping', 'browser', 'os', 'deviceCategory']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-53" type="checkbox"><label for="sk-estimator-id-53" class="sk-toggleable__label sk-toggleable__label-arrow">RareLabelEncoder</label><div class="sk-toggleable__content"><pre>RareLabelEncoder(ignore_format=True, n_categories=1, replace_with='other',
                 tol=0.1, variables=['source', 'browser'])</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-54" type="checkbox"><label for="sk-estimator-id-54" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre></pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-55" type="checkbox"><label for="sk-estimator-id-55" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-56" type="checkbox"><label for="sk-estimator-id-56" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop='first', dtype=&lt;class 'int'&gt;, handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-57" type="checkbox"><label for="sk-estimator-id-57" class="sk-toggleable__label sk-toggleable__label-arrow">DropCorrelatedFeatures</label><div class="sk-toggleable__content"><pre>DropCorrelatedFeatures(threshold=0.7)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-58" type="checkbox"><label for="sk-estimator-id-58" class="sk-toggleable__label sk-toggleable__label-arrow">RandomOverSampler</label><div class="sk-toggleable__content"><pre>RandomOverSampler(random_state=88, sampling_strategy=0.1)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-59" type="checkbox"><label for="sk-estimator-id-59" class="sk-toggleable__label sk-toggleable__label-arrow">BetaDistClassifier</label><div class="sk-toggleable__content"><pre>BetaDistClassifier(a=0.4, b=2.5, random_state=88)</pre></div></div></div></div></div></div></div>
</div>
</div>
<p>Export untrained model object to disk</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model_filepath <span class="op">=</span> os.path.join(model_rub_dir_path, <span class="st">'model.joblib'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> joblib.dump(pipe_new, model_filepath)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="next-step" class="level2">
<h2 class="anchored" data-anchor-id="next-step">Next Step</h2>
<p>The trained model associated with the best experiment run (having the best evaluation metric) will be retrieved. This model will be registered in the MLFlow model registry so that it can be accessed in production to make inference predictions.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../../../index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Welcome</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../notebooks/02-train/notebooks/05_get_best_model.html" class="pagination-link">
        <span class="nav-page-text">Register Model</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>